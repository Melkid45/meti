import Splide from"https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.esm.js";const isTouchDevice=!(!("ontouchstart"in window)&&!navigator.maxTouchPoints);function onEntry(t){t.forEach((t=>{t.isIntersecting&&t.target.classList.add("element-show")}))}ScrollTrigger.normalizeScroll(!0),gsap.ticker.lagSmoothing(0),ScrollTrigger.config({limitCallbacks:!0,autoAdjustLag:!0});let currentScroll,currentTime=new Date,formattedTime=currentTime.getHours().toString().padStart(2,"0")+":"+currentTime.getMinutes().toString().padStart(2,"0");document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".currentTime").forEach((t=>{t.textContent=formattedTime}))}));let lenis=new Lenis({lerp:.1,smoothWheel:!0,duration:1.2,easing:t=>Math.min(1,1.001-Math.pow(2,-10*t)),autoRaf:!0,smooth:!0,infinite:!1,touchMultiplier:1.5});if($(window).width()>1024&&!isTouchDevice){let t=0,e=!1;const i=5,s=50;lenis.on("scroll",(({scroll:n})=>{ScrollTrigger.update(),currentScroll=n;const o=document.querySelector(".header");Math.abs(currentScroll-t)>i&&(e=currentScroll>t,t=currentScroll),e&&currentScroll>s?o.classList.add("back"):o.classList.remove("back")}))}else lenis.on("scroll",(({scroll:t})=>{ScrollTrigger.update(),currentScroll=t}));let options={threshold:[.5]},observer=new IntersectionObserver(onEntry,options),elements=document.querySelectorAll(".element-animation");for(let n of elements)observer.observe(n);$(".burger").on("click",(function(t){$(".header__mobile").toggleClass("show"),$(this).find(".current").toggleClass("show")})),$(".header__mobile-menu ul li").on("click",(function(t){$(".header__mobile").removeClass("show"),$(".burger").find(".current").removeClass("show")}));let archorTime=!1;if(window.addEventListener("load",(()=>{ScrollTrigger.refresh(),lenis.scrollTo(0),lenis.emit(),lenis.resize(),lenis.raf(0),setTimeout((()=>{document.querySelectorAll('a[href^="#"]').forEach((t=>{t.addEventListener("click",(e=>{archorTime=!0,setTimeout((()=>{archorTime=!1}),1e3),e.preventDefault();const i=document.querySelector(t.getAttribute("href"));let s=i.parentNode;if(console.log(s),s.classList.contains("pin-spacer")){const t=s.previousElementSibling,e=t.clientHeight;lenis.scrollTo(t.offsetTop+e,{lerp:.1,duration:2.5})}else lenis.scrollTo(i,{lerp:.1,duration:2.5})}))}))}),500)})),window.addEventListener("resize load",(()=>controller.update(!0))),window.addEventListener("hashchange",(()=>{ScrollTrigger.refresh()})),document.querySelector(".splide")){var splide=new Splide(".splide",{rewind:!0,type:"loop",arrows:!1,pagination:!1});splide.mount()}let width=$(window).width();width<=820?($(".header__body-menu").remove(),$(".about-p1").remove(),$(".difference-desk").remove(),$(".brand").attr("placeholder","Имя бренда"),$(".awards__desk").remove()):width>=1024&&isTouchDevice?($(".cursor").remove(),$(".header__body-menu").remove(),$(".difference-mobile").remove(),$(".muteor").remove(),$(".splide").remove(),$(".about-p2").remove()):($(".burger").remove(),$(".about-p2").remove(),$(".difference-mobile").remove(),$(".header__mobile").remove(),$(".muteor").remove(),$(".splide").remove());let isGifLoaded=!1,isPageLoaded=!1;function loadGifWhenReady(){if(isPageLoaded&&!isGifLoaded){document.querySelectorAll('img[src*=".gif"], img[src*=".GIF"]').forEach((t=>{const e=t.src;t.src="",setTimeout((()=>{t.src=e,isGifLoaded=!0}),100)}))}}window.addEventListener("load",(()=>{isPageLoaded=!0,setTimeout(loadGifWhenReady,1e3)}));const ABOUTCONFIG={animCanvas:-250,StartAnim:"top top",StartAnimPixel:"top top",endAnim:"+=30%"};window.innerWidth<=820&&(ABOUTCONFIG.animCanvas=-50,ABOUTCONFIG.StartAnim="top center",ABOUTCONFIG.StartAnimPixel="+=30%",ABOUTCONFIG.endAnim="+=30%"),gsap.to(".about-parallax",{y:ABOUTCONFIG.animCanvas,scrollTrigger:{trigger:".about",start:ABOUTCONFIG.StartAnim,end:"bottom center",scrub:2,ease:"sine.inOut"}}),gsap.to(".ab_dec1",{y:0,opacity:1,scrollTrigger:{trigger:".about",start:"-=60%",end:"-=20%",scrub:2,ease:"sine.inOut"}}),gsap.to(".ab_dec2",{y:0,opacity:1,scrollTrigger:{trigger:".about",start:"-=20%",end:"+=40%",scrub:2,ease:"sine.inOut"}}),gsap.to(".ab_dec3",{y:0,opacity:1,scrollTrigger:{trigger:".about",start:"+=10%",end:"+=30%",scrub:2,ease:"sine.inOut"}}),gsap.to(".benefits__decor--1",{y:0,opacity:1,scrollTrigger:{trigger:".benefits",start:"-=50%",end:"+=30%",scrub:2,ease:"sine.inOut"}}),document.addEventListener("DOMContentLoaded",(()=>{const t=window.innerWidth>820;class e{constructor(e){this.media=e,this.img=e.querySelector("img"),this.canvas=e.querySelector(".grid-canvas-case"),this.ctx=this.canvas.getContext("2d"),this.isGif=this.img.src.toLowerCase().endsWith(".gif"),this.superGif=null,this.currentGifFrame=null,this.pixelSize={value:40},this.isPixelationComplete=!1,this.originalCanvas=document.createElement("canvas"),this.originalCtx=this.originalCanvas.getContext("2d"),this.pixelCanvas=document.createElement("canvas"),this.pixelCtx=this.pixelCanvas.getContext("2d"),this.blurCanvas=document.createElement("canvas"),this.blurCtx=this.blurCanvas.getContext("2d"),this.zoomCanvas=document.createElement("canvas"),this.zoomCtx=this.zoomCanvas.getContext("2d"),this.isGridActive=!1,this.mouse={x:-1e3,y:-1e3},this.settings={cellSize:54,effectRadius:120,blurRadius:120,fillColor:"rgba(244,244,244,0.9)",zoomFactor:5,zoomRadius:120,zoomTransition:.25},this.isInitialized=!1,this.isBlurWorking=!1,this.isBlurDone=!1,this.lastGifUpdate=0,this.gifFrameRate=100,this.isGif?this.initGif():this.img.complete?this.init():this.img.addEventListener("load",(()=>this.init()),{once:!0}),this._onResize=function(t,e=150){let i;return(...s)=>{clearTimeout(i),i=setTimeout((()=>t(...s)),e)}}((()=>{this.isInitialized&&(this.resizeAll(),this.updateOriginalCanvas(),t&&!isTouchDevice&&(this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur()))}),200),window.addEventListener("resize",this._onResize)}initGif(){"undefined"!=typeof SuperGif?(this.superGif=new SuperGif({gif:this.img}),this.superGif.load((()=>{console.log("GIF загружен"),this.currentGifFrame=0,this.init(),this.startGifAnimation()}))):console.error("libgif-js не загружен")}updateGifFrame(){if(!this.superGif||!this.superGif.get_canvas())return;const e=this.superGif.get_canvas();this.drawImageCover(this.originalCtx,e,this.originalCanvas.width,this.originalCanvas.height),t&&this.isBlurDone&&!isTouchDevice&&(this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur())}updateOriginalCanvas(){if(this.isGif&&this.superGif&&this.superGif.get_canvas()){const t=this.superGif.get_canvas();this.drawImageCover(this.originalCtx,t,this.originalCanvas.width,this.originalCanvas.height)}else this.drawImageCover(this.originalCtx,this.img,this.originalCanvas.width,this.originalCanvas.height)}resizeAll(){this.canvas.width=this.media.offsetWidth,this.canvas.height=this.media.offsetHeight,this.originalCanvas.width=this.canvas.width,this.originalCanvas.height=this.canvas.height,this.pixelCanvas.width=Math.max(1,Math.floor(this.canvas.width/Math.max(1,this.pixelSize.value))),this.pixelCanvas.height=Math.max(1,Math.floor(this.canvas.height/Math.max(1,this.pixelSize.value))),this.blurCanvas.width=this.canvas.width,this.blurCanvas.height=this.canvas.height,this.zoomCanvas.width=this.canvas.width,this.zoomCanvas.height=this.canvas.height}init(){this.isInitialized||(this.isInitialized=!0,this.resizeAll(),this.updateOriginalCanvas(),t&&!isTouchDevice&&(this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur()),this.setupEvents(),this.setupScrollAnimation(),this.render())}startGifAnimation(){if(!this.isGif||!this.superGif)return;const t=e=>{e-this.lastGifUpdate>this.gifFrameRate&&(this.lastGifUpdate=e,this.superGif.move_to((this.currentGifFrame+1)%this.superGif.get_length()),this.currentGifFrame=(this.currentGifFrame+1)%this.superGif.get_length(),this.updateGifFrame()),requestAnimationFrame(t)};requestAnimationFrame(t)}drawImageCover(t,e,i,s){const n=e.width/e.height;let o,a,r,l;i/s>n?(o=i,a=i/n,r=0,l=(s-a)/2):(a=s,o=s*n,r=(i-o)/2,l=0),t.clearRect(0,0,i,s),t.drawImage(e,r,l,o,a)}applyBlur(){if(!this.blurCtx||!this.originalCtx)return;if(this.isBlurWorking)return;this.isBlurWorking=!0,this.isBlurDone=!1;const t=this.blurCanvas.width,e=this.blurCanvas.height,i=Math.max(0,Math.floor(this.settings.blurRadius)),s=this.originalCtx.getImageData(0,0,t,e),n=s.data,o=t,a=e,r=o+1,l=a+1;if(this.blurCtx.putImageData(s,0,0),0===i)return this.isBlurWorking=!1,void(this.isBlurDone=!0);const h=r*l,c=new Float64Array(h),d=new Float64Array(h),u=new Float64Array(h);let m=1;const g=Math.max(8,Math.floor(2e5/o)),f=(t,e,i,s,n)=>{const o=i*r+e,a=i*r+(s+1),l=(n+1)*r+e;return t[(n+1)*r+(s+1)]-t[a]-t[l]+t[o]},p=this.blurCtx.createImageData(o,a),v=p.data,w=Math.max(4,Math.floor(1e5/o)),C=this,x=()=>{const t=Math.min(a,m+g-1);for(let e=m;e<=t;e++){let t=0,i=0,s=0;const a=(e-1)*o*4;for(let l=1;l<=o;l++){const o=a+4*(l-1);t+=n[o],i+=n[o+1],s+=n[o+2];const h=e*r+l,m=(e-1)*r+l;c[h]=c[m]+t,d[h]=d[m]+i,u[h]=u[m]+s}}m=t+1,m<=a?setTimeout(x,0):y(0)};function y(t){const e=Math.min(a-1,t+w-1);for(let s=t;s<=e;s++)for(let t=0;t<o;t++){const e=Math.max(0,t-i),r=Math.min(o-1,t+i),l=Math.max(0,s-i),h=Math.min(a-1,s+i),m=(r-e+1)*(h-l+1),g=f(c,e,l,r,h),p=f(d,e,l,r,h),w=f(u,e,l,r,h),C=4*(s*o+t);v[C]=Math.round(g/m),v[C+1]=Math.round(p/m),v[C+2]=Math.round(w/m),v[C+3]=n[4*(s*o+t)+3]}try{C.blurCtx.putImageData(p,0,0,0,t,o,e-t+1)}catch(t){C.blurCtx.putImageData(p,0,0)}e<a-1?setTimeout((()=>y(e+1)),0):(C.isBlurWorking=!1,C.isBlurDone=!0)}setTimeout(x,0)}renderPixelated(t){const e=this.canvas,i=this.ctx,s=Math.max(1,Math.floor(e.width/Math.max(1,t))),n=Math.max(1,Math.floor(e.height/Math.max(1,t)));this.pixelCanvas.width===s&&this.pixelCanvas.height===n||(this.pixelCanvas.width=s,this.pixelCanvas.height=n),this.pixelCtx.clearRect(0,0,this.pixelCanvas.width,this.pixelCanvas.height),this.pixelCtx.drawImage(this.originalCanvas,0,0,this.originalCanvas.width,this.originalCanvas.height,0,0,this.pixelCanvas.width,this.pixelCanvas.height),i.imageSmoothingEnabled=!1,i.clearRect(0,0,e.width,e.height),i.drawImage(this.pixelCanvas,0,0,this.pixelCanvas.width,this.pixelCanvas.height,0,0,e.width,e.height)}drawGrid(){if(!t&&isTouchDevice)return;if(!this.blurCanvas||!this.isBlurDone)return;const{cellSize:e,effectRadius:i,zoomFactor:s,zoomRadius:n,zoomTransition:o}=this.settings,a=this.mouse.x,r=this.mouse.y,l=Math.max(0,Math.floor((a-i)/e)),h=Math.min(Math.ceil(this.canvas.width/e),Math.ceil((a+i)/e)),c=Math.max(0,Math.floor((r-i)/e)),d=Math.min(Math.ceil(this.canvas.height/e),Math.ceil((r+i)/e)),u=i*i,m=n*n;for(let t=c;t<d;t++)for(let s=l;s<h;s++){const n=s*e,o=t*e,l=n+e/2,h=o+e/2,c=(l-a)*(l-a)+(h-r)*(h-r);if(c<u){this.ctx.drawImage(this.blurCanvas,n,o,e,e,n,o,e,e);const t=.01*(1-Math.sqrt(c)/i);this.ctx.fillStyle=`rgba(244,244,244,${t.toFixed(3)})`,this.ctx.fillRect(n,o,e,e)}}for(let t=c;t<d;t++)for(let i=l;i<h;i++){const l=i*e,h=t*e,c=l+e/2,d=h+e/2,u=(c-a)*(c-a)+(d-r)*(d-r);if(u<m){const t=1-Math.sqrt(u)/n,i=1+(s-1)*t,c=e/i,d=e,m=l+e/2-(a-(l+e/2))*(i-1)-c/2,g=h+e/2-(r-(h+e/2))*(i-1)-c/2,f=Math.max(0,Math.min(this.originalCanvas.width-c,m)),p=Math.max(0,Math.min(this.originalCanvas.height-c,g));this.zoomCtx.clearRect(0,0,this.zoomCanvas.width,this.zoomCanvas.height),this.zoomCtx.drawImage(this.originalCanvas,f,p,c,c,l,h,d,d);const v=Math.min(1,t/o);this.ctx.save(),this.ctx.globalAlpha=v,this.ctx.drawImage(this.zoomCanvas,l,h,d,d,l,h,d,d),this.ctx.restore()}}}render(){this.isPixelationComplete?(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.originalCanvas,0,0)):this.renderPixelated(this.pixelSize.value),t&&!isTouchDevice&&this.isGridActive&&this.drawGrid(),requestAnimationFrame((()=>this.render()))}setupScrollAnimation(){gsap.to(this.pixelSize,{value:1,scrollTrigger:{trigger:".about",start:ABOUTCONFIG.StartAnimPixel,end:ABOUTCONFIG.endAnim,scrub:1,ease:"sine.inOut",onComplete:()=>{this.isPixelationComplete=!0}}})}setupEvents(){!t&&isTouchDevice||(this.media.addEventListener("mousemove",(t=>{const e=this.canvas.getBoundingClientRect();this.mouse.x=t.clientX-e.left,this.mouse.y=t.clientY-e.top,this.isGridActive=!0})),this.media.addEventListener("mouseleave",(()=>{this.isGridActive=!1})))}}setTimeout((function t(){if("complete"===document.readyState){document.querySelectorAll(".about_canva").forEach((t=>{new e(t)}))}else window.addEventListener("load",t,{once:!0})}),1e3)})),width>750&&document.addEventListener("DOMContentLoaded",(()=>{const t={squareSize:40,fillColor:"#000000",initialFillRatio:.3,animationDuration:25,staggerDelay:1};width<=750&&(t.squareSize=20);const e=document.querySelector(".feedback_btn"),i=e.querySelector(".btn_canvas"),s=i.getContext("2d");let n=[],o=!1;function a(){const s=e.offsetWidth,o=e.offsetHeight;i.width=s,i.height=o;const a=t.squareSize*parseFloat(getComputedStyle(document.documentElement).fontSize);const l=Math.ceil(s/a),h=Math.ceil(o/a);n=[];for(let e=0;e<h;e++)for(let i=0;i<l;i++)n.push({x:i*a,y:e*a,width:a,height:a,filled:Math.random()<t.initialFillRatio,initialFilled:!1,progress:0});n.forEach((t=>{t.initialFilled=t.filled})),r()}function r(){s.clearRect(0,0,i.width,i.height),n.forEach((e=>{(e.filled||e.progress>0)&&(s.fillStyle=t.fillColor,s.globalAlpha=e.filled?1:e.progress,s.fillRect(Math.round(e.x),Math.round(e.y),Math.round(e.width)+1,Math.round(e.height)+1),s.globalAlpha=1)}))}async function l(e,i,s){return new Promise((n=>{setTimeout((()=>{const s=performance.now();requestAnimationFrame((function o(a){const l=a-s,h=Math.min(l/t.animationDuration,1);e.progress=i?h:1-h,r(),h<1?requestAnimationFrame(o):(e.filled=i,e.progress=0,n())}))}),s)}))}a(),e.addEventListener("mouseenter",(async function(){o=!0;const e=[...n].sort((()=>Math.random()-.5));for(let i=0;i<e.length&&o;i++){const s=e[i];s.filled||await l(s,!0,i*t.staggerDelay)}})),e.addEventListener("mouseleave",(async function(){o=!1;const e=[...n].sort((()=>Math.random()-.5));for(let i=0;i<e.length&&!o;i++){const s=e[i];s.filled&&!s.initialFilled&&await l(s,!1,i*t.staggerDelay)}})),window.addEventListener("resize",a)})),document.addEventListener("DOMContentLoaded",(()=>{new ScrollMagic.Controller;const t=window.innerWidth>820,e=window.innerWidth<=820;function i(t,e=150){let i;return(...s)=>{clearTimeout(i),i=setTimeout((()=>t(...s)),e)}}function s(t,e,i,s){const n=e.naturalWidth/e.naturalHeight;let o,a,r,l;i/s>n?(o=i,a=i/n,r=0,l=(s-a)/2):(a=s,o=s*n,r=(i-o)/2,l=0),t.clearRect(0,0,i,s),t.drawImage(e,r,l,o,a)}class n{constructor(e){this.media=e,this.img=e.querySelector("img"),this.canvas=e.querySelector(".grid-canvas-case"),this.ctx=this.canvas.getContext("2d"),this.pixelSize=40,this.pixelCanvas=document.createElement("canvas"),this.pixelCtx=this.pixelCanvas.getContext("2d"),this.isGridActive=!1,this.mouse={x:-1e3,y:-1e3},this.originalCanvas=document.createElement("canvas"),this.originalCtx=this.originalCanvas.getContext("2d"),this.blurCanvas=document.createElement("canvas"),this.blurCtx=this.blurCanvas.getContext("2d"),this.zoomCanvas=document.createElement("canvas"),this.zoomCtx=this.zoomCanvas.getContext("2d"),this.rafId=null,this.isInitialized=!1,this.isBlurWorking=!1,this.isBlurDone=!1,this.settings={cellSize:54,effectRadius:120,blurRadius:120,fillColor:"rgba(244,244,244,0.9)",zoomFactor:5,zoomRadius:120,zoomTransition:.25},this.visibilityObserver=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(this.visibilityObserver.unobserve(this.media),this.img.complete?this.init():this.img.addEventListener("load",(()=>this.init()),{once:!0}))}))}),{threshold:.05,rootMargin:"400px"});const n=this.media.getBoundingClientRect();n.top<window.innerHeight+400&&n.bottom>-400&&this.img.complete?this.init():this.visibilityObserver.observe(this.media),this._onResize=i((()=>{this.isInitialized&&(this.resizeCanvas(),this.originalCanvas.width=this.canvas.width,this.originalCanvas.height=this.canvas.height,s(this.originalCtx,this.img,this.originalCanvas.width,this.originalCanvas.height),t&&!isTouchDevice&&(this.blurCanvas.width=this.canvas.width,this.blurCanvas.height=this.canvas.height,this.zoomCanvas.width=this.canvas.width,this.zoomCanvas.height=this.canvas.height,this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur()),this.requestRender())}),200),window.addEventListener("resize",this._onResize)}resizeCanvas(){this.canvas.width=this.media.offsetWidth,this.canvas.height=this.media.offsetHeight}init(){this.isInitialized||(this.isInitialized=!0,this.resizeCanvas(),this.originalCanvas.width=this.canvas.width,this.originalCanvas.height=this.canvas.height,s(this.originalCtx,this.img,this.originalCanvas.width,this.originalCanvas.height),t&&!isTouchDevice&&(this.blurCanvas.width=this.canvas.width,this.blurCanvas.height=this.canvas.height,this.zoomCanvas.width=this.canvas.width,this.zoomCanvas.height=this.canvas.height,this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur()),this.setupEvents(),this.requestRender())}setupEvents(){!t&&isTouchDevice||(this._onMouseMove=t=>{const e=this.canvas.getBoundingClientRect();this.mouse.x=t.clientX-e.left,this.mouse.y=t.clientY-e.top,this.isGridActive=!0,this.requestRender()},this._onMouseLeave=()=>{this.isGridActive=!1,this.requestRender()},this.media.addEventListener("mousemove",this._onMouseMove),this.media.addEventListener("mouseleave",this._onMouseLeave))}applyBlur(){if(!this.blurCtx||!this.originalCtx)return;if(this.isBlurWorking)return;this.isBlurWorking=!0,this.isBlurDone=!1;const t=this.blurCanvas.width,e=this.blurCanvas.height,i=Math.max(0,Math.floor(this.settings.blurRadius)),s=this.originalCtx.getImageData(0,0,t,e),n=s.data,o=t,a=e,r=o+1,l=a+1;if(this.blurCtx.putImageData(s,0,0),0===i)return this.isBlurWorking=!1,void(this.isBlurDone=!0);const h=r*l,c=new Float64Array(h),d=new Float64Array(h),u=new Float64Array(h);let m=1;const g=Math.max(8,Math.floor(2e5/o)),f=()=>{const t=Math.min(a,m+g-1);for(let e=m;e<=t;e++){let t=0,i=0,s=0;const a=(e-1)*o*4;for(let l=1;l<=o;l++){const o=a+4*(l-1);t+=n[o],i+=n[o+1],s+=n[o+2];const h=e*r+l,m=(e-1)*r+l;c[h]=c[m]+t,d[h]=d[m]+i,u[h]=u[m]+s}}m=t+1,m<=a?setTimeout(f,0):y(0)},p=(t,e,i,s,n)=>{const o=i*r+e,a=i*r+(s+1),l=(n+1)*r+e;return t[(n+1)*r+(s+1)]-t[a]-t[l]+t[o]},v=this.blurCtx.createImageData(o,a),w=v.data,C=Math.max(4,Math.floor(1e5/o)),x=this;function y(t){const e=Math.min(a-1,t+C-1);for(let s=t;s<=e;s++)for(let t=0;t<o;t++){const e=Math.max(0,t-i),r=Math.min(o-1,t+i),l=Math.max(0,s-i),h=Math.min(a-1,s+i),m=(r-e+1)*(h-l+1),g=p(c,e,l,r,h),f=p(d,e,l,r,h),v=p(u,e,l,r,h),C=4*(s*o+t);w[C]=Math.round(g/m),w[C+1]=Math.round(f/m),w[C+2]=Math.round(v/m),w[C+3]=n[4*(s*o+t)+3]}try{x.blurCtx.putImageData(v,0,0,0,t,o,e-t+1)}catch(t){x.blurCtx.putImageData(v,0,0)}e<a-1?setTimeout((()=>y(e+1)),0):(x.isBlurWorking=!1,x.isBlurDone=!0)}setTimeout(f,0)}renderPixelated(t){const e=this.ctx,i=this.canvas;if(!this.originalCanvas)return void(this.img&&(e.clearRect(0,0,i.width,i.height),e.drawImage(this.img,0,0,i.width,i.height)));const s=Math.max(1,Math.floor(i.width/Math.max(1,t))),n=Math.max(1,Math.floor(i.height/Math.max(1,t)));this.pixelCanvas.width===s&&this.pixelCanvas.height===n||(this.pixelCanvas.width=s,this.pixelCanvas.height=n),this.pixelCtx.clearRect(0,0,this.pixelCanvas.width,this.pixelCanvas.height),this.pixelCtx.drawImage(this.originalCanvas,0,0,this.originalCanvas.width,this.originalCanvas.height,0,0,this.pixelCanvas.width,this.pixelCanvas.height),e.imageSmoothingEnabled=!1,e.clearRect(0,0,i.width,i.height),e.drawImage(this.pixelCanvas,0,0,this.pixelCanvas.width,this.pixelCanvas.height,0,0,i.width,i.height)}drawGrid(){if(!t&&isTouchDevice)return;if(!this.blurCanvas||!this.isBlurDone)return;const{cellSize:e,effectRadius:i,zoomFactor:s,zoomRadius:n,zoomTransition:o}=this.settings,a=this.mouse.x,r=this.mouse.y,l=Math.max(0,Math.floor((a-i)/e)),h=Math.min(Math.ceil(this.canvas.width/e),Math.ceil((a+i)/e)),c=Math.max(0,Math.floor((r-i)/e)),d=Math.min(Math.ceil(this.canvas.height/e),Math.ceil((r+i)/e)),u=i*i,m=n*n;for(let t=c;t<d;t++)for(let s=l;s<h;s++){const n=s*e,o=t*e,l=n+e/2,h=o+e/2,c=(l-a)*(l-a)+(h-r)*(h-r);if(c<u){this.ctx.drawImage(this.blurCanvas,n,o,e,e,n,o,e,e);const t=.01*(1-Math.sqrt(c)/i);this.ctx.fillStyle=`rgba(244,244,244,${t.toFixed(3)})`,this.ctx.fillRect(n,o,e,e)}}for(let t=c;t<d;t++)for(let i=l;i<h;i++){const l=i*e,h=t*e,c=l+e/2,d=h+e/2,u=(c-a)*(c-a)+(d-r)*(d-r);if(u<m){const t=1-Math.sqrt(u)/n,i=1+(s-1)*t,c=e/i,d=e,m=l+e/2-(a-(l+e/2))*(i-1)-c/2,g=h+e/2-(r-(h+e/2))*(i-1)-c/2,f=Math.max(0,Math.min(this.originalCanvas.width-c,m)),p=Math.max(0,Math.min(this.originalCanvas.height-c,g));this.zoomCtx.clearRect(0,0,this.zoomCanvas.width,this.zoomCanvas.height),this.zoomCtx.drawImage(this.originalCanvas,f,p,c,c,l,h,d,d);const v=Math.min(1,t/o);this.ctx.globalAlpha=v,this.ctx.drawImage(this.zoomCanvas,l,h,d,d,l,h,d,d),this.ctx.globalAlpha=1}}}requestRender(){this.rafId||(this.rafId=requestAnimationFrame((()=>{this.renderPixelated(this.pixelSize),t&&!isTouchDevice&&this.isGridActive&&this.drawGrid(),this.rafId=null})))}stop(){window.removeEventListener("resize",this._onResize),this.media&&this._onMouseMove&&(this.media.removeEventListener("mousemove",this._onMouseMove),this.media.removeEventListener("mouseleave",this._onMouseLeave)),this.visibilityObserver&&this.visibilityObserver.disconnect(),this.rafId&&cancelAnimationFrame(this.rafId)}setPixelSize(t){this.pixelSize=t,this.requestRender()}}const o=document.querySelector(".case__soft"),a=Array.from(o.querySelectorAll(".item")),r=document.querySelector(".load-more");let l=3;function h(){e?(a.forEach(((t,e)=>{e<l?(t.classList.add("item--visible"),t.style.display="flex"):(t.classList.remove("item--visible"),t.style.display="none")})),l>=a.length?r.style.display="none":r.style.display="flex"):(a.forEach(((t,e)=>{t.classList.add("item--visible"),t.style.display="flex"})),r.style.display="none")}h();const c=[];let d,u=0;function m(){const i=o.querySelectorAll(".item--visible");d=a.length-l,$(".case-count").text(`[${d}]`),i.forEach((s=>{const a=s.querySelector(".media");if(!a._effectInitialized){const s=new n(a);c.push(s),a._effectInitialized=!0;const l=s.img,h=()=>{u++,l.removeEventListener("load",h),u===i.length&&function(){const i=o.querySelectorAll(".item--visible");g&&(g.scrollTrigger.kill(),g.kill(),g=null);let s;s=t?window.innerHeight*(i.length-1)/2:window.innerHeight*(i.length-1)*3;g=gsap.timeline({scrollTrigger:{trigger:".case",start:"top top",end:()=>`+=${s}`,scrub:.5,pin:!0,onUpdate:t=>{t.progress>=.6&&t.progress<.9?r.classList.add("animate"):r.classList.remove("animate")}}}),setTimeout((()=>{lenis.emit(),lenis.resize(),lenis.raf(0)}),300),i.forEach(((i,s)=>{const n=c.find((t=>t.media===i.querySelector(".media")));let o,a=0;a=i.classList.contains("small_case")?-260:-220,o=isTouchDevice&&!e&&window.innerWidth>1024?30:isTouchDevice&&!e&&window.innerWidth<=1024&&window.innerHeight>=1e3?130:0;const r=1,l=.5,h=t?.2:.6;t||(a=-240),window.innerWidth<500&&(a=-250),window.innerWidth<821&&window.innerWidth>=750&&(a=-250);let d=null;const u=gsap.timeline().fromTo(i,{yPercent:o,opacity:1},{yPercent:a,opacity:1,duration:r}).to({size:40},{size:1,duration:l,ease:"power2.out",onUpdate(){const t=Math.round(this.targets()[0].size);t!==d&&(d=t,n.pixelSize=t,n.requestRender())}},0);g.add(u,s*h)}))}()};l.complete?setTimeout((()=>h()),0):l.addEventListener("load",h)}}))}let g=null;r.addEventListener("click",(()=>{if(e){lenis.scroll;l+=3,h(),m(),setTimeout((()=>{const t=o.querySelectorAll(".item--visible")[l-3];if(t){const e=t.getBoundingClientRect().top+window.pageYOffset;lenis.scrollTo(e,{immimmediate:!0})}const e=a.length-l;$(".case-count").text(`[${e}]`)}),0)}})),window.addEventListener("resize",i((()=>{window.innerWidth<=820!==e?window.location.reload():g&&g.scrollTrigger&&g.scrollTrigger.refresh()}),250)),m(),window.addEventListener("beforeunload",(()=>{c.forEach((t=>t.stop&&t.stop()))}));let f=Array.from(document.querySelectorAll("[data-circular-text]"));const p={size:12,radius:53,showPath:!0,spread:!0,inside:!1,texts:[]};f.forEach(((t,e)=>{p.texts[e]=t.dataset.circularText||"Your text • ";const i=t.querySelector(".circlePath");if(i){i.id=`circlePath${e}`;const s=t.querySelector(".textPath");s&&(s.setAttribute("href",`#${i.id}`),s.textContent=p.texts[e])}})),f.forEach(((t,e)=>{const i=t.querySelector(".circlePath"),s=t.querySelector(".textPath");if(!i||!s)return;const n=`\n        M ${65-p.radius}, 65\n        a ${p.radius},${p.radius} 0 1,${p.inside?0:1} ${2*p.radius},0\n        a ${p.radius},${p.radius} 0 1,${p.inside?0:1} -${2*p.radius},0\n      `;i.setAttribute("d",n),s.textContent=p.texts[e],i.style.setProperty("--show",p.showPath?1:0),p.spread?s.setAttribute("textLength",2*Math.PI*p.radius*.95):s.removeAttribute("textLength")}))}));const video=document.querySelector(".showreel__video");if(window.innerWidth>1024&&document.querySelector(".cursor")){gsap.set(".cursor",{xPercent:-50,yPercent:-50});let o=!1,a=0,r=0,l=null;const h=document.querySelector(".cursor"),c=document.querySelector(".default_text"),d=document.querySelector(".showreel"),u=$(h),m=$(c),g=$(d);function moveCursor(t,e){gsap.to(u,{x:t,y:e,duration:.1,ease:"power1.out"})}function updateVideoCursor(){if(!video)return;const t=!video.paused&&!video.ended;u.stop(!0).animate({width:"40rem",height:"40rem"},200),u.find(".arrow").css("scale","0"),u.find(".pause").css("scale",t?"1":"0"),u.find(".play").css("scale",t?"0":"1"),m.stop(!0,!0).fadeIn(200).text(t?ConFigNames.pause:ConFigNames.play)}function resetCursor(){u.find("svg").css("scale","0"),m.stop(!0,!0).fadeOut(200),u.stop(!0).animate({width:"20rem",height:"20rem"},200)}function checkCursorPosition(t,e){if(!d)return;const i=d.getBoundingClientRect(),s=t>=i.left-2&&t<=i.right+2&&e>=i.top-2&&e<=i.bottom+2;l&&clearTimeout(l),s&&!o?l=setTimeout((()=>{o=!0,updateVideoCursor()}),50):!s&&o&&(l=setTimeout((()=>{o=!1,resetCursor()}),50))}$("button").on("mouseover",(function(t){u.stop(!0).animate({width:"40rem",height:"40rem"},200)})),$("button").on("mouseout",(function(t){u.stop(!0).animate({width:"20rem",height:"20rem"},200),u.find("svg").css("scale","0")})),$(document).on("mousemove",(function(t){a=t.clientX,r=t.clientY,moveCursor(a,r),checkCursorPosition(a,r)})).on("mouseenter","a",(function(){const t=$(this).attr("href")||"";m.stop(!0,!0).fadeIn(200),u.stop(!0).animate({width:"40rem",height:"40rem"},200),t.includes("tel")?(m.text(ConFigNames.phone),u.find(".phone").css("scale","1").siblings("svg").not(".arrow, .phone").css("scale","0")):t.includes("mail")?(m.text(ConFigNames.email),u.find(".mail").css("scale","1").siblings("svg").not(".arrow, .mail").css("scale","0")):t.includes("#")?(m.text(""),u.find(".arrow").css("scale","0").siblings("svg").not(".arrow").css("scale","0")):(m.text(""),u.find(".arrow").css("scale","1").siblings("svg").not(".arrow").css("scale","0"))})).on("mouseleave","a",(function(){o?updateVideoCursor():resetCursor()})),g.on("click",(function(t){video&&(t.preventDefault(),video.paused||video.ended?video.play().catch((t=>console.error("Video play error:",t))):video.pause(),updateVideoCursor())})),$(document).on("mouseleave",(function(){o=!1,resetCursor()})),$(window).on("scroll resize",(function(){checkCursorPosition(a,r)})),$((function(){resetCursor()})),$(window).on("resize",(function(){window.innerWidth<=750&&($(document).off("mousemove mouseenter mouseleave"),$(window).off("scroll resize"),l&&clearTimeout(l))}))}else $(".muteor").on("click",(function(){console.log(1),video&&(video.muted=!video.muted,$(this).find(".mute").toggle(!video.muted),$(this).find(".sound").toggle(video.muted))}));class BodyGrid{constructor(t={}){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.settings={baseSizeRem:54,activationRadiusRem:120,trailLifetime:100,gridColor:{r:39,g:39,b:39},borderWidthRem:1,disappearChance:.25},this.zonesSelector=t.zonesSelector||".feedback, footer",this.scrollEl=this.resolveScrollEl(t.scrollContainer),this.cells=new Map,this.mouse={xRem:-1e3,yRem:-1e3,inside:!1,lastClientX:0,lastClientY:0},this.lastMouseMoveTime=performance.now(),this.idleTimeout=100,this.updateRemSize(),this.initCanvas(),this.addEvents(),this.animate()}resolveScrollEl(t){if(!t)return window;if(t instanceof Element)return t;return document.querySelector(t)||window}updateRemSize(){this.remPx=parseFloat(getComputedStyle(document.documentElement).fontSize)||16}getScrollXpx(){return this.scrollEl===window?window.scrollX||0:this.scrollEl.scrollLeft||0}getScrollYpx(){return this.scrollEl===window?window.scrollY||0:this.scrollEl.scrollTop||0}getScrollXRem(){return this.getScrollXpx()/this.remPx}getScrollYRem(){return this.getScrollYpx()/this.remPx}getViewWidthPx(){return this.scrollEl===window?window.innerWidth:this.scrollEl.clientWidth}getViewHeightPx(){return this.scrollEl===window?window.innerHeight:this.scrollEl.clientHeight}getViewWidthRem(){return this.getViewWidthPx()/this.remPx}getViewHeightRem(){return this.getViewHeightPx()/this.remPx}initCanvas(){this.canvas.style.position="fixed",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="-1",document.body.appendChild(this.canvas),this.resizeCanvas(),window.addEventListener("resize",(()=>{this.updateRemSize(),this.resizeCanvas()}))}resizeCanvas(){const t=window.devicePixelRatio||1;this.canvas.width=Math.floor(window.innerWidth*t),this.canvas.height=Math.floor(window.innerHeight*t),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(t,t),this.pixelRatio=t}addEvents(){document.addEventListener("mousemove",(t=>{this.lastMouseMoveTime=performance.now(),this.mouse.lastClientX=t.clientX,this.mouse.lastClientY=t.clientY;const e=t.clientX+this.getScrollXpx(),i=t.clientY+this.getScrollYpx();this.mouse.xRem=e/this.remPx,this.mouse.yRem=i/this.remPx,this.mouse.inside=!0,this.updateHoverColorAtPoint(t.clientX,t.clientY)}),{passive:!0});const t=()=>{if(!this.mouse.inside)return;const t=this.getScrollYpx(),e=this.mouse.lastClientY+t;let i=!1;document.querySelectorAll(this.zonesSelector).forEach((s=>{const n=s.getBoundingClientRect(),o=n.top+t,a=n.bottom+t;e>=o&&e<=a&&(i=!0)})),this.settings.gridColor=i?{r:90,g:69,b:199}:{r:39,g:39,b:39}};this.scrollEl===window?window.addEventListener("scroll",t,{passive:!0}):this.scrollEl.addEventListener("scroll",t,{passive:!0}),document.addEventListener("mouseout",(()=>{this.mouse.xRem=-1e3,this.mouse.yRem=-1e3,this.mouse.inside=!1,this.settings.gridColor={r:39,g:39,b:39}}),{passive:!0})}updateHoverColorAtPoint(t,e){if(!this.mouse.inside)return void(this.settings.gridColor={r:39,g:39,b:39});let i=document.elementsFromPoint(t,e).some((t=>t.closest(this.zonesSelector)));if(!i){const t=this.getScrollYpx(),s=e+t;document.querySelectorAll(this.zonesSelector).forEach((e=>{const n=e.getBoundingClientRect(),o=n.top+t,a=n.bottom+t;s>=o&&s<=a&&(i=!0)}))}this.settings.gridColor=i?{r:90,g:69,b:199}:{r:39,g:39,b:39}}isIdle(){return performance.now()-this.lastMouseMoveTime>this.idleTimeout}updateCells(){const t=performance.now(),e=this.settings.activationRadiusRem,i=this.settings.baseSizeRem;if(this.mouse.inside&&!this.isIdle()){const s=this.mouse.xRem,n=this.mouse.yRem,o=Math.floor((s-e)/i),a=Math.floor((s+e)/i),r=Math.floor((n-e)/i),l=Math.floor((n+e)/i);for(let h=r;h<=l;h++)for(let r=o;r<=a;r++){const o=s-(r*i+i/2),a=n-(h*i+i/2);if(o*o+a*a<=e*e){const e=`${r}_${h}`;this.cells.set(e,{lastActive:t,life:this.settings.trailLifetime})}}}for(let[t,e]of this.cells)e.life-=16,e.life<=0&&(Math.random()<this.settings.disappearChance?this.cells.delete(t):e.life=50+50*Math.random())}draw(){const t=this.ctx,e=this.settings.baseSizeRem,i=this.getScrollXRem(),s=this.getScrollYRem(),n=this.getViewWidthRem(),o=this.getViewHeightRem();t.clearRect(0,0,this.canvas.width,this.canvas.height),t.strokeStyle=`rgb(${this.settings.gridColor.r},${this.settings.gridColor.g},${this.settings.gridColor.b})`,t.lineWidth=this.settings.borderWidthRem*this.remPx/this.pixelRatio;const a=Math.floor(i/e)-1,r=Math.floor((i+n)/e)+1,l=Math.floor(s/e)-1,h=Math.floor((s+o)/e)+1,c=this.remPx;for(let n=l;n<=h;n++)for(let o=a;o<=r;o++){const a=`${o}_${n}`;if(!this.cells.has(a))continue;const r=(o*e-i)*c,l=(n*e-s)*c,h=e*c;t.strokeRect(r,l,h,h)}}animate(){this.updateCells(),this.draw(),requestAnimationFrame((()=>this.animate()))}}window.innerWidth>1024&&!isTouchDevice&&document.addEventListener("DOMContentLoaded",(()=>{new BodyGrid({zonesSelector:".feedback, footer"})})),document.addEventListener("DOMContentLoaded",(()=>{const t={squareSize:54,gap:0,fillColor:"#442CBF",bgColor:"#000000",animationDuration:800,widthView:1920};function e(e){return e*(window.innerWidth/t.widthView)}window.innerWidth<=750&&(t.widthView=375,t.squareSize=20,t.animationDuration=500);const i=document.getElementById("feedback-grid-canvas"),s=i.getContext("2d");let n=[],o=[],a=0;function r(){const r=document.querySelector(".feedback__top"),h=r.clientWidth,c=r.clientHeight,d=window.devicePixelRatio||1;i.style.width=h+"px",i.style.height=c+"px",i.width=h*d,i.height=c*d,s.scale(d,d);const u=e(t.squareSize),m=e(t.gap),g=Math.ceil(h/(u+m)),f=Math.ceil(c/(u+m));n=[];for(let t=0;t<f;t++)for(let e=0;e<g;e++)n.push({x:0+e*(u+m),y:0+t*(u+m),width:u,height:u,filled:!1});o=[...Array(n.length).keys()],function(t){for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}}(o),a=0,l()}function l(){s.clearRect(0,0,i.width,i.height),s.imageSmoothingEnabled=!1,s.fillStyle=t.bgColor,s.fillRect(0,0,i.width,i.height),n.forEach((e=>{const i=e.x,n=e.y,o=e.width;s.fillStyle=e.filled?t.fillColor:t.bgColor,s.fillRect(i,n,o+.5,o+.5)}))}const h=new ScrollMagic.Controller;let c;new ScrollMagic.Scene({triggerElement:".feedback",duration:t.animationDuration,triggerHook:1}).on("progress",(t=>{!function(t){if(t<a)for(let e=a-1;e>=t;e--)e>=0&&e<o.length&&(n[o[e]].filled=!1);else for(let e=a;e<t;e++)e>=0&&e<o.length&&(n[o[e]].filled=!0);a=t,l()}(Math.floor(t.progress*n.length))})).addTo(h),r(),window.addEventListener("resize",(()=>{clearTimeout(c),c=setTimeout((()=>{window.innerWidth<=750?(t.widthView=375,t.squareSize=20,t.animationDuration=500):(t.widthView=1920,t.squareSize=54,t.animationDuration=1e3),r(),h.update()}),100)}))})),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});const tippyInstances=[];$(".input__wrap p").each((function(t){const e=$(this).parents(".input__wrap").find("input").attr("name"),i=$(this).attr("data-tippy"),s=tippy(this,{content:`${i}`,placement:"top",animation:"fade",arrow:!0,name:e,theme:"custom",trigger:"mouseenter manual"});tippyInstances.push(s)})),$(".feedback_btn").on("click",(function(t){let e=0,i={};if($(".inputs input").each((function(){const t=$(this).attr("name");if(""==$(this).val())$(this).addClass("error"),tippyInstances.forEach((e=>{e.props.name==t&&e.show()}));else{$(this).removeClass("error"),tippyInstances.forEach((e=>{e.props.name==t&&e.hide()})),e++;const s=$(this).attr("name");i[s]=$(this).val()}})),5==e)if($(".feedback_btn").hasClass("send_feedback"))$.ajax({url:"/feedback",type:"POST",data:i,success:function(t){$(".feedback__bot-form").fadeOut(300),$(".feedback__bot-thank").fadeIn(300);const e=$(".title__feed").attr("data-success");$(".title__feed").text(e)},error:function(t,e,i){console.error(i)}});else{$(".feedback__bot-form").fadeOut(300),$(".feedback__bot-thank").fadeIn(300);const t=$(".title__feed").attr("data-success");$(".title__feed").text(t)}})),document.addEventListener("DOMContentLoaded",(()=>{const t={squareSize:54,gap:0,fillColor:"#000000",bgColor:"#F4F4F400",animationDuration:500,widthView:1920};width<=750&&(t.widthView=375,t.squareSize=20);const e=document.getElementById("grid-canvas-begin"),i=e.getContext("2d");let s=[],n=[],o=0;function a(){const a=document.querySelector(".main"),l=a.clientWidth,h=a.clientHeight,c=window.devicePixelRatio||1;e.width=Math.ceil(l*c),e.height=Math.ceil(h*c),i.setTransform(1,0,0,1,0,0),i.scale(c,c);const d=Math.round(t.squareSize*(window.innerWidth/t.widthView));const u=Math.ceil(l/d),m=Math.ceil(h/d),g=u*d,f=m*d;Math.floor((l-g)/2),Math.floor((h-f)/2);s=[];for(let t=0;t<=m;t++)for(let e=0;e<=u;e++)s.push({x:e*d,y:t*d,width:d+1,height:d+1,filled:!1});n=[...Array(s.length).keys()],function(t){for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}}(n),o=0,r()}function r(){i.clearRect(0,0,e.width,e.height),i.imageSmoothingEnabled=!1,i.fillStyle=t.bgColor,i.fillRect(0,0,e.width,e.height),s.forEach((e=>{i.fillStyle=e.filled?t.fillColor:t.bgColor,i.fillRect(e.x,e.y,e.width,e.height)}))}const l=new ScrollMagic.Controller;let h;new ScrollMagic.Scene({triggerElement:".main",duration:t.animationDuration,triggerHook:0}).on("progress",(t=>{!function(t){if(t<o)for(let e=o-1;e>=t;e--)e>=0&&e<n.length&&(s[n[e]].filled=!1);else for(let e=o;e<t;e++)e>=0&&e<n.length&&(s[n[e]].filled=!0);o=t,r()}(Math.floor(t.progress*s.length))})).addTo(l),a(),window.addEventListener("resize",(()=>{clearTimeout(h),h=setTimeout((()=>{a(),l.update()}),100)}))})),document.addEventListener("DOMContentLoaded",(()=>{const t={squareSize:54,fillColor:"#442CBF",bgColor:"#000000",animationDelay:500,fillDuration:1500,fadeDuration:2500,logoMoveDuration:1e3,targetLogoPosition:{x:40,y:53},sizeLogo:{width:200,height:50}};window.innerWidth<=820&&(t.squareSize=20);const e=document.querySelector(".preload-container"),i=document.querySelector(".preload-canvas"),s=i.getContext("2d"),n=e.querySelector("img"),o=document.querySelector("#js-cursor-progress span");let a,r,l=[],h={x:0,y:0},c=!1;function d(){i.width=window.innerWidth,i.height=window.innerHeight;const e=Math.ceil(i.width/t.squareSize)+1,s=Math.ceil(i.height/t.squareSize)+1;l=[];for(let i=-1;i<s;i++)for(let s=-1;s<e;s++)l.push({x:s*t.squareSize,y:i*t.squareSize,width:t.squareSize,height:t.squareSize,state:"black",alpha:1});m(),u()}function u(){for(let t=l.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[l[t],l[e]]=[l[e],l[t]]}}function m(){s.clearRect(0,0,i.width,i.height),l.forEach((e=>{"black"===e.state?(s.fillStyle=t.bgColor,s.globalAlpha=e.alpha,s.fillRect(e.x,e.y,e.width,e.height)):"color"===e.state&&(s.fillStyle=t.fillColor,s.globalAlpha=e.alpha,s.fillRect(e.x,e.y,e.width,e.height))})),s.globalAlpha=1}function g(e){r||(r=e);const i=e-r,s=Math.min(i/t.fillDuration,1),n=Math.floor(s*l.length);for(let t=0;t<n;t++)t<l.length&&(l[t].state="color");if(document.querySelector(".cursor")){const t=Math.floor(99*s);o.textContent=`${t.toString().padStart(2,"0")}%`}m(),s<1?a=requestAnimationFrame(g):(r=null,u(),a=requestAnimationFrame(f))}function f(s){r||(r=s),i.style.background="transparent";const h=s-r,c=Math.min(h/t.fadeDuration,1),d=Math.min(h/t.logoMoveDuration,1);u=d,Math.pow(1-u,3);var u;setTimeout((()=>{n.animate({opacity:0},1e3)}),1500),setTimeout((()=>{$(".main__body .stroke div").addClass("anim_stroke")}),2e3);const g=Math.floor(c*l.length);for(let t=0;t<g;t++)t<l.length&&(l[t].state="transparent",l[t].alpha=1-c);document.querySelector(".cursor")&&o.parentElement&&(o.parentElement.style.opacity=1-c),m(),c<1?a=requestAnimationFrame(f):(e.style.transition="opacity 0.5s ease",e.style.opacity="0",setTimeout((()=>{e.remove()}),500))}function p(){if(!c)return;const e=(window.innerWidth-n.offsetWidth)/2,i=(window.innerHeight-n.offsetHeight)/2;h={x:e/parseFloat(getComputedStyle(document.documentElement).fontSize),y:i/parseFloat(getComputedStyle(document.documentElement).fontSize)},setTimeout((()=>{r=null,a=requestAnimationFrame(g)}),t.animationDelay)}d(),function(){const t=document.querySelector(".priority-video");t?4===t.readyState?(c=!0,p()):(t.addEventListener("loadeddata",(()=>{c=!0,p()})),t.addEventListener("error",(()=>{console.warn("Priority video failed to load, starting animation anyway"),c=!0,p()})),setTimeout((()=>{c||(console.warn("Priority video loading timeout, starting animation"),c=!0,p())}),5e3)):(console.warn("Priority video not found, starting animation"),c=!0,p())}(),window.addEventListener("resize",(()=>{a&&cancelAnimationFrame(a),d(),m()}))})),$.fn.shuffleLetters=function(t){const e=$.extend({step:8,fps:60,text:"",duration:1e3,symbols:"!<>-_[]{}—=+*^?#%$@",symbolsProbability:1,callback:function(){}},t);function i(t){let e=[];for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];3===n.nodeType?e.push(n):1===n.nodeType&&(e=e.concat(i(n)))}return e}function s(t){return" "===t?"space":/[a-z]/.test(t)?"lowerLetter":/[A-Z]/.test(t)?"upperLetter":/[А-ЯЁ]/.test(t)?"rusUpperLetter":/[а-яё]/.test(t)?"rusLowerLetter":"symbol"}function n(t,i,n){if(n&&Math.random()<e.symbolsProbability&&e.symbols.length>0)return e.symbols[Math.floor(Math.random()*e.symbols.length)];let o=i.filter((e=>s(e)===t));return 0===o.length&&(o=i.filter((e=>"rusUpperLetter"===t||"rusLowerLetter"===t?/[А-Яа-яЁё]/.test(e):"upperLetter"===t||"lowerLetter"===t?/[A-Za-z]/.test(e):"symbol"===s(e)))),o.length>0?o[Math.floor(Math.random()*o.length)]:""}return this.each((function(){const t=$(this);if(t.data("animated"))return;t.data("animated",!0);const o=t.html();t.data("originalHtml",o),t.find(".shuffle-wrapper").length||t.html('<span class="shuffle-wrapper">'+o+"</span>");const a=i(t.find(".shuffle-wrapper")[0]),r=[];a.forEach((t=>{r.push(...t.textContent.split(""))}));const l=[];a.forEach((t=>{t.textContent.split("").forEach(((e,i)=>{l.push({node:t,index:i,char:e,type:s(e)})}))}));const h=l.reduce(((t,e,i)=>("space"!==e.type&&t.push(i),t)),[]);let c=null;const d=1e3/e.fps;let u=0;requestAnimationFrame((function i(s){if(c||(c=s),s-u<d)return void requestAnimationFrame(i);u=s;const m=Math.min((s-c)/e.duration,1),g=a.map((t=>t.textContent.split(""))),f=Math.floor(m*h.length),p=Math.random()<e.symbolsProbability*(1-m);h.forEach(((t,e)=>{const i=l[t],s=a.indexOf(i.node);e<f?m>.95||Math.random()>.3?g[s][i.index]=i.char:g[s][i.index]=n(i.type,r,p):g[s][i.index]=n(i.type,r,!0)})),a.forEach(((t,e)=>{t.textContent=g[e].join("")})),m<1?requestAnimationFrame(i):(t.data("animated",!1),t.html(o),e.callback(t))}))}))};const isFullEffect=window.innerWidth>820,timeOutShape=isFullEffect?400:200;!function(){gsap.registerPlugin(ScrollTrigger);const t=14,e=parseFloat(getComputedStyle(document.documentElement).fontSize),i=54*e,s=1*e,n="#272727",o=["#442CBF"],a=.16,r=.84,l={heart:[[1,6],[1,5],[1,4],[2,3],[3,2],[4,2],[5,3],[6,4],[7,4],[8,3],[9,2],[10,2],[11,3],[12,4],[12,5],[12,6],[11,7],[10,8],[9,9],[8,10],[7,11],[6,11],[5,10],[4,9],[3,8],[2,7]],sound:[[6,11],[5,10],[4,9],[3,8],[2,8],[1,8],[1,7],[1,6],[1,5],[2,5],[3,5],[4,4],[5,3],[6,2],[6,3],[6,4],[6,5],[6,6],[6,7],[6,8],[6,9],[6,10],[8,9],[9,9],[10,8],[10,7],[10,6],[10,5],[9,4],[8,4],[8,11],[9,11],[10,11],[11,10],[12,9],[12,8],[12,7],[12,6],[12,5],[12,4],[11,3],[10,2],[9,2],[8,2]],glass:[[6,7],[6,6],[7,6],[7,7],[0,6],[0,7],[1,5],[2,4],[3,3],[4,3],[5,2],[6,2],[7,2],[8,2],[9,3],[10,3],[11,4],[12,5],[13,6],[13,7],[12,8],[11,9],[10,10],[9,10],[8,11],[7,11],[6,11],[5,11],[4,10],[3,10],[2,9],[1,8]],cmile:[[1,8],[1,7],[1,6],[1,5],[2,4],[2,3],[3,2],[4,2],[5,1],[6,1],[7,1],[8,1],[9,2],[10,2],[11,3],[11,4],[12,5],[12,6],[12,7],[12,8],[11,9],[11,10],[10,11],[9,11],[8,12],[7,12],[6,12],[5,12],[4,11],[3,11],[2,10],[2,9],[5,6],[5,5],[5,4],[8,6],[8,5],[8,4],[4,8],[5,9],[6,9],[7,9],[8,9],[9,8]],kind:[[8,1],[7,1],[6,1],[5,1],[4,2],[3,2],[2,3],[2,4],[1,5],[1,6],[1,7],[1,8],[2,9],[2,10],[3,11],[4,11],[5,12],[6,12],[7,12],[8,12],[9,11],[10,11],[11,10],[11,9],[12,8],[12,7],[12,6],[12,5],[10,2],[10,3],[11,3],[9,4],[8,5],[7,6],[6,6],[6,7],[7,7],[6,4],[5,4],[4,5],[4,6],[4,7],[4,8],[5,9],[6,9],[7,9],[8,9],[9,8],[9,7]],creative:[[8,1],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7],[6,8],[5,7],[5,6],[5,5],[4,5],[6,5],[4,8],[3,7],[3,6],[3,5],[3,4],[2,3],[1,4],[1,5],[1,6],[1,7],[1,8],[1,9],[2,10],[3,11],[4,12],[5,12],[6,12],[7,12],[8,11],[9,11],[10,10],[11,9],[11,8],[12,7],[12,6],[12,5],[11,5],[10,6],[9,6],[9,7],[9,5],[9,4],[9,3],[9,2]],camera:[[1,2],[2,2],[3,2],[4,2],[5,2],[6,2],[7,2],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],[8,9],[8,10],[8,11],[7,11],[6,11],[5,11],[4,11],[3,11],[2,11],[1,11],[1,10],[1,9],[1,8],[1,7],[1,6],[1,5],[1,4],[1,3],[9,5],[10,4],[11,3],[12,2],[12,3],[12,4],[12,5],[12,6],[12,7],[12,8],[12,9],[12,10],[12,11],[11,10],[10,9],[9,8]],photo:[[1,3],[2,3],[3,3],[4,3],[5,3],[6,3],[7,3],[8,3],[9,3],[10,3],[11,3],[12,3],[12,4],[12,5],[12,6],[12,7],[12,8],[12,9],[12,10],[12,11],[11,11],[10,11],[9,11],[8,11],[7,11],[6,11],[5,11],[4,11],[3,11],[2,11],[1,11],[1,10],[1,9],[1,8],[1,7],[1,6],[1,5],[1,4],[3,2],[4,2],[8,6],[9,6],[10,7],[10,8],[9,9],[8,9],[7,8],[7,7]],arrow:[[1,12],[1,11],[1,10],[2,9],[3,8],[4,7],[5,6],[6,5],[7,4],[8,3],[9,2],[10,1],[12,1],[11,0],[13,2],[12,3],[11,4],[10,5],[9,6],[8,7],[7,8],[6,9],[5,10],[4,11],[3,12],[2,12],[3,10],[10,3]]},h=Array.from(document.querySelectorAll(".items__line .item")),c=$(".items__line .item h3"),d=document.querySelector(".wrapper"),u=document.querySelector(".items__line");if(!h||0===h.length)return;let m=h.length;$(".items__line .item").each((function(){$(this).find(".total-slides").text(`0${m}`)}));const g=h.map((t=>t.dataset.item)),f=[],p=[];const v=document.getElementById("interactive-grid");h.forEach(((e,o)=>{let a;0===o&&v?(a=v,d.contains(a)||d.appendChild(a)):(a=document.createElementNS("http://www.w3.org/2000/svg","svg"),a.classList.add("interactive-grid"),d.appendChild(a)),f.push(a);const{cellsGrid:r,allCells:l}=function(e){const o=[],a=[],r=s/2;for(let s=0;s<t;s++){o[s]=[];for(let n=0;n<t;n++){const t=document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttribute("x",n*i+r),t.setAttribute("y",s*i+r),t.setAttribute("width",i),t.setAttribute("height",i),t.setAttribute("fill","transparent"),e.appendChild(t),o[s][n]=t,a.push(t)}}for(let o=0;o<=t;o++){const a=document.createElementNS("http://www.w3.org/2000/svg","line"),l=o*i+r;a.setAttribute("x1",l),a.setAttribute("y1",r),a.setAttribute("x2",l),a.setAttribute("y2",t*i+r),a.setAttribute("stroke",n),a.setAttribute("stroke-width",s),e.appendChild(a)}for(let o=0;o<=t;o++){const a=document.createElementNS("http://www.w3.org/2000/svg","line"),l=o*i+r;a.setAttribute("x1",r),a.setAttribute("y1",l),a.setAttribute("x2",t*i+s),a.setAttribute("y2",l),a.setAttribute("stroke",n),a.setAttribute("stroke-width",s),e.appendChild(a)}return e.setAttribute("viewBox",`0 0 ${t*i+s} ${t*i+s}`),e.setAttribute("width",t*i+s),e.setAttribute("height",t*i+s),{cellsGrid:o,allCells:a}}(a);p.push({cellsGrid:r,allCells:l})}));const w=Array.from(document.querySelectorAll(".interactive-grid"));function C(){const t=d.clientHeight;u.style.height=h.length*t+"px",h.forEach((e=>e.style.height=t+"px")),u.style.top="0px"}function x(e,i=0,s=!1){(i<0||i>=p.length)&&(i=0);const{cellsGrid:n,allCells:a}=p[i];if(s||!e)return gsap.killTweensOf(a),void gsap.set(a,{attr:{fill:"transparent"}});const r=l[e];if(!r)return gsap.killTweensOf(a),void gsap.set(a,{attr:{fill:"transparent"}});const h=r.map((([t,e])=>n[e]?.[t])).filter(Boolean);gsap.killTweensOf(a),gsap.set(a,{attr:{fill:"transparent"}}),gsap.to(h,{attr:{fill:o[0]},duration:.55,ease:"power2.out",stagger:{each:.03,from:"center",grid:[t,t]}})}gsap.set(w,{clipPath:"inset(100% 0 0 0)"}),w[0]&&gsap.set(w[0],{clipPath:"inset(0% 0 0 0)"}),C(),window.addEventListener("resize",C);const y=document.scrollingElement||document.documentElement,b={index:0,animating:!1,steps:g.length-1};let S,M=!1;x(g[0],0);function E(){const t=document.querySelector(".services__new");if(!t)return!1;const e=t.getBoundingClientRect();return e.top<window.innerHeight&&e.bottom>0}const z=ScrollTrigger.create({trigger:".services__new",start:"top -5.5%",end:"+="+g.length*d.clientHeight*10,pin:!0,scrub:!1,pinType:"fixed",onUpdate:t=>{const e=t.progress;if(h.forEach(((t,e)=>{const i=w[e];if(!i)return;const s=t.getBoundingClientRect(),n=d.getBoundingClientRect(),o=n.bottom-s.top,l=n.top-s.bottom;let h=0;if(o>0&&l<0){const t=n.height*r-n.height*a;h=(o-n.height*a)/(t||1),h=Math.min(1,Math.max(0,h))}i.style.clipPath=`inset(${100-100*h}% 0 0 0)`})),!b.animating&&archorTime){const t=Math.min(Math.floor(e*(b.steps+1)),b.steps);t==h.length-1&&(M=!0),t!==b.index&&R(t,{duration:.2})}}});requestAnimationFrame((function t(e){void 0!==lenis&&"function"==typeof lenis.raf&&lenis.raf(e),ScrollTrigger.update(),requestAnimationFrame(t)}));let T=0,A=0,L=0;async function R(t,e={}){if(b.animating||S==t)return;const i=Math.max(0,Math.min(t,b.steps));b.index=i,b.animating=!0,L=0;const s=d.clientHeight,n=-i*s;S=t,console.log(t),gsap.to(u,{y:n,duration:e.duration??.8,ease:e.ease??"power2.inOut",onComplete:()=>{b.animating=!1,b.index===b.steps&&gsap.to(u,{y:-b.index*d.clientHeight,duration:.1,ease:"power1.out"})}}),console.log(currentScroll),setTimeout((()=>{x(g[i],i)}),timeOutShape),c&&c.eq(i).length&&c.eq(i).shuffleLetters({step:5,fps:60,text:c.eq(i).text(),duration:700}),t!==h.length-1||archorTime||(setTimeout((()=>{currentScroll<=z.end&&lenis.scrollTo(z.end,{immediate:!0})}),1e3),M=!0,setTimeout((()=>{currentScroll<=z.end&&z.scroll(z.end)}),1100)),0===t&&M&&!archorTime&&void 0!==lenis&&(M=!1,setTimeout((()=>{currentScroll>=z.start&&lenis.scrollTo(z.start,{immediate:!0})}),1e3),setTimeout((()=>{currentScroll>=z.start&&z.scroll(z.start)}),1100))}const q=document.querySelector(".services__new");q.addEventListener("wheel",(function(t){if(!E()||b.animating)return;if(!z.isActive)return;const e=0===b.index,i=b.index===b.steps;if(e&&t.deltaY<0||i&&t.deltaY>0)return;t.preventDefault(),t.stopPropagation(),L+=t.deltaY,L>=50?R(b.index+1):L<=-50&&R(b.index-1)}),{passive:!1}),q.addEventListener("touchstart",(function(t){z.isActive&&(T=t.touches[0].clientY,A=0)}),{passive:!1}),q.addEventListener("touchmove",(function(t){z.isActive&&(A=t.touches[0].clientY-T,t.preventDefault())}),{passive:!1}),q.addEventListener("touchend",(function(){if(!E()||b.animating)return;if(!z.isActive)return;R(A<-40?b.index+1:A>40?b.index-1:b.index)}),{passive:!1}),q.addEventListener("keydown",(function(t){if(!E()||b.animating)return;if(!z.isActive)return;const e=0===b.index,i=b.index===b.steps;if(["ArrowDown","PageDown"," "].includes(t.key))i||R(b.index+1);else{if(!["ArrowUp","PageUp"].includes(t.key))return;e||R(b.index-1)}t.preventDefault()})),window.addEventListener("resize",(()=>ScrollTrigger.refresh())),ScrollTrigger.addEventListener("refreshInit",(()=>{b.animating&&gsap.killTweensOf(y)})),ScrollTrigger.addEventListener("refresh",(function(){E()&&R(b.index,{duration:.001,ease:"none"})})),setTimeout((()=>{if(E()){const t=z.progress,e=Math.round(t*b.steps);b.index=e,R(e,{duration:.001})}}),0)}(),document.addEventListener("DOMContentLoaded",(function(){const t=parseFloat(getComputedStyle(document.documentElement).fontSize)||16,e={squareSize:54,gap:0,fillColor:"rgba(244, 244, 244, 0.00)",bgColor:"#000000",fillDuration:.45,delayDuration:.1,clearDuration:.45},i=document.querySelector(".showreel")||document.body,s=document.getElementById("grid-canvas-video");if(!s)return void console.warn("Не найден canvas#grid-canvas-video");const n=s.getContext("2d");function o(e){return e*t}(window.innerWidth||document.documentElement.clientWidth)<=820&&(e.squareSize=20);let a=[],r=[],l=0,h=0;const c=e.fillDuration+e.delayDuration+e.clearDuration;function d(){const t=i.clientWidth,c=i.clientHeight,d=window.devicePixelRatio||1;s.style.width=t+1+"px",s.style.height=c+1+"px",s.width=Math.ceil(t*d),s.height=Math.ceil(c*d),n.setTransform(1,0,0,1,0,0),n.scale(d,d),n.imageSmoothingEnabled=!1;const u=o(e.squareSize),g=o(e.gap);l=Math.ceil(t/(u+g)),h=Math.ceil(c/(u+g)),a=[];for(let t=0;t<h;t++)for(let e=0;e<l;e++)a.push({x:e*(u+g),y:t*(u+g),width:u+1,height:u+1,filled:!1});r=Array.from({length:a.length},((t,e)=>e));for(let t=r.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[r[t],r[e]]=[r[e],r[t]]}m()}function u(t,e,i){return Math.max(e,Math.min(i,t))}function m(){n.clearRect(0,0,s.width,s.height),a.forEach((t=>{n.fillStyle=t.filled?e.fillColor:e.bgColor,n.fillRect(t.x,t.y,t.width,t.height)}))}d(),function(){if("undefined"==typeof ScrollMagic)return void console.warn("ScrollMagic не найден — вызов updateAnimation(progress) можно сделать вручную.");const t=new ScrollMagic.Controller,i=Math.max(100,200*c);new ScrollMagic.Scene({triggerElement:".showreel",duration:`${i}%`,triggerHook:1}).on("progress",(function(t){!function(t){const i=(t=u(t,0,1))*c,s=e.fillDuration,n=s+e.delayDuration;let o=0;if(i<=s){const t=s>0?i/s:1;o=Math.round(t*a.length)}else if(i<=n)o=a.length;else{const t=1-u(e.clearDuration>0?(i-n)/e.clearDuration:1,0,1);o=Math.round(t*a.length)}o=u(o,0,a.length);for(let t=0;t<a.length;t++){const e=r[t];a[e].filled=t<o}m()}(t.progress)})).addTo(t)}();const g=new ResizeObserver((t=>{for(let e of t)e.target===i&&d()}));g.observe(i),window.addEventListener("beforeunload",(()=>{g.disconnect()}))}));