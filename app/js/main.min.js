import"./splide.js";const isTouchDevice=!(!("ontouchstart"in window)&&!navigator.maxTouchPoints);function onEntry(t){t.forEach(t=>{t.isIntersecting&&t.target.classList.add("element-show")})}ScrollTrigger.normalizeScroll(!0),gsap.ticker.lagSmoothing(0),ScrollTrigger.config({limitCallbacks:!0,autoAdjustLag:!0});let currentScroll,currentTime=new Date,formattedTime=currentTime.getHours().toString().padStart(2,"0")+":"+currentTime.getMinutes().toString().padStart(2,"0");document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".currentTime").forEach(t=>{t.textContent=formattedTime})});let lenis=new Lenis({lerp:.1,smoothWheel:!0,duration:1.2,easing:t=>Math.min(1,1.001-Math.pow(2,-10*t)),autoRaf:!0,smooth:!0,infinite:!1,touchMultiplier:1.5});if($(window).width()>1024&&!isTouchDevice){let t=0,e=!1;const i=5,n=50;lenis.on("scroll",({scroll:o})=>{ScrollTrigger.update(),currentScroll=o;const s=document.querySelector(".header");Math.abs(currentScroll-t)>i&&(e=currentScroll>t,t=currentScroll),e&&currentScroll>n?s.classList.add("back"):s.classList.remove("back")})}else lenis.on("scroll",({scroll:t})=>{ScrollTrigger.update(),currentScroll=t});let options={threshold:[.5]},observer=new IntersectionObserver(onEntry,options),elements=document.querySelectorAll(".element-animation");for(let o of elements)observer.observe(o);$(".burger").on("click",function(t){$(".header__mobile").toggleClass("show"),$(this).find(".current").toggleClass("show")}),$(".header__mobile-menu ul li").on("click",function(t){$(".header__mobile").removeClass("show"),$(".burger").find(".current").removeClass("show")});let archorTime=!1;if(window.addEventListener("load",()=>{ScrollTrigger.refresh(),lenis.scrollTo(0),lenis.emit(),lenis.resize(),lenis.raf(0),setTimeout(()=>{document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",e=>{archorTime=!0,setTimeout(()=>{archorTime=!1},1e3),e.preventDefault();const i=document.querySelector(t.getAttribute("href"));let n=i.parentNode;if(console.log(n),n.classList.contains("pin-spacer")){const t=n.previousElementSibling,e=t.clientHeight;lenis.scrollTo(t.offsetTop+e,{lerp:.1,duration:2.5})}else lenis.scrollTo(i,{lerp:.1,duration:2.5})})})},500)}),window.addEventListener("resize load",()=>controller.update(!0)),window.addEventListener("hashchange",()=>{ScrollTrigger.refresh()}),document.querySelector(".splide")){var splide=new Splide(".splide",{rewind:!0,type:"loop",arrows:!1,pagination:!1});splide.mount()}let width=$(window).width();width<=820?($(".header__body-menu").remove(),$(".about-p1").remove(),$(".difference-desk").remove(),$(".brand").attr("placeholder","Имя бренда"),$(".awards__desk").remove()):width>=1024&&isTouchDevice?($(".header__body-menu").remove(),$(".difference-mobile").remove(),$(".muteor").remove(),$(".splide").remove(),$(".about-p2").remove()):($(".burger").remove(),$(".about-p2").remove(),$(".difference-mobile").remove(),$(".header__mobile").remove(),$(".muteor").remove(),$(".splide").remove());const ABOUTCONFIG={animCanvas:-250,StartAnim:"top top",StartAnimPixel:"top top",endAnim:"+=30%"};window.innerWidth<=820&&(ABOUTCONFIG.animCanvas=-50,ABOUTCONFIG.StartAnim="top center",ABOUTCONFIG.StartAnimPixel="+=30%",ABOUTCONFIG.endAnim="+=30%"),gsap.to(".about-parallax",{y:ABOUTCONFIG.animCanvas,scrollTrigger:{trigger:".about",start:ABOUTCONFIG.StartAnim,end:"bottom center",scrub:2,ease:"sine.inOut"}}),gsap.to(".ab_dec1",{y:0,opacity:1,scrollTrigger:{trigger:".about",start:"-=60%",end:"-=20%",scrub:2,ease:"sine.inOut"}}),gsap.to(".ab_dec2",{y:0,opacity:1,scrollTrigger:{trigger:".about",start:"-=20%",end:"+=40%",scrub:2,ease:"sine.inOut"}}),gsap.to(".ab_dec3",{y:0,opacity:1,scrollTrigger:{trigger:".about",start:"+=10%",end:"+=30%",scrub:2,ease:"sine.inOut"}}),gsap.to(".benefits__decor--1",{y:0,opacity:1,scrollTrigger:{trigger:".benefits",start:"-=50%",end:"+=30%",scrub:2,ease:"sine.inOut"}}),document.addEventListener("DOMContentLoaded",()=>{const t=window.innerWidth>820,e="ontouchstart"in window||navigator.maxTouchPoints>0;class i{constructor(i){this.media=i,this.video=i.querySelector("video"),this.canvas=i.querySelector(".grid-canvas-case"),this.ctx=this.canvas.getContext("2d"),this.isVideo=this.video&&this.video.src.toLowerCase().match(/\.(mp4|webm|ogg)$/),this.currentVideoFrame=null,this.pixelSize={value:40},this.isPixelationComplete=!1,this.originalCanvas=document.createElement("canvas"),this.originalCtx=this.originalCanvas.getContext("2d"),this.pixelCanvas=document.createElement("canvas"),this.pixelCtx=this.pixelCanvas.getContext("2d"),this.blurCanvas=document.createElement("canvas"),this.blurCtx=this.blurCanvas.getContext("2d"),this.zoomCanvas=document.createElement("canvas"),this.zoomCtx=this.zoomCanvas.getContext("2d"),this.isGridActive=!1,this.mouse={x:-1e3,y:-1e3},this.settings={cellSize:54,effectRadius:120,blurRadius:120,fillColor:"rgba(244,244,244,0.9)",zoomFactor:5,zoomRadius:120,zoomTransition:.25},this.isInitialized=!1,this.isBlurWorking=!1,this.isBlurDone=!1,this.lastVideoUpdate=0,this.videoFrameRate=1e3/30,this.isVideoPlaying=!1,this.isVideo?this.initVideo():console.error("Video element not found"),this._onResize=function(t,e=150){let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>t(...n),e)}}(()=>{this.isInitialized&&(this.resizeAll(),this.updateOriginalCanvas(),t&&!e&&(this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur()))},200),window.addEventListener("resize",this._onResize)}async initVideo(){this.video.muted=!0,this.video.loop=!0,this.video.playsInline=!0,this.video.setAttribute("preload","auto"),this.video.setAttribute("autoplay","true"),this.video.addEventListener("loadeddata",()=>{this.startVideoPlayback()}),this.video.addEventListener("canplay",()=>{this.startVideoPlayback()}),this.video.addEventListener("play",()=>{this.isVideoPlaying=!0,this.init(),this.startVideoAnimation()}),this.video.addEventListener("error",t=>{console.error("Video loading error:",t)}),this.video.load(),await this.startVideoPlayback()}async startVideoPlayback(){if(this.isVideoPlaying)return;const t=await async function(t){try{t.muted=!0,t.playsInline=!0,t.loop=!0,t.pause(),t.currentTime=0,await new Promise(t=>setTimeout(t,100));const e=t.play();return void 0===e||(await e,!0)}catch(e){const i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});document.dispatchEvent(i),await new Promise(t=>setTimeout(t,200));try{return await t.play(),!0}catch(t){return console.error("Final video play error:",t),!1}}}(this.video);t&&(this.isVideoPlaying=!0,this.init(),this.startVideoAnimation())}updateVideoFrame(){if(this.video&&!(this.video.readyState<2))try{this.drawImageCover(this.originalCtx,this.video,this.originalCanvas.width,this.originalCanvas.height),t&&this.isBlurDone&&!e&&(this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur())}catch(t){console.log("Error drawing video frame:",t)}}updateOriginalCanvas(){this.isVideo&&this.video.readyState>=2?this.drawImageCover(this.originalCtx,this.video,this.originalCanvas.width,this.originalCanvas.height):(this.originalCtx.fillStyle="#000000",this.originalCtx.fillRect(0,0,this.originalCanvas.width,this.originalCanvas.height))}resizeAll(){this.canvas.width=this.media.offsetWidth,this.canvas.height=this.media.offsetHeight,this.originalCanvas.width=this.canvas.width,this.originalCanvas.height=this.canvas.height,this.pixelCanvas.width=Math.max(1,Math.floor(this.canvas.width/Math.max(1,this.pixelSize.value))),this.pixelCanvas.height=Math.max(1,Math.floor(this.canvas.height/Math.max(1,this.pixelSize.value))),this.blurCanvas.width=this.canvas.width,this.blurCanvas.height=this.canvas.height,this.zoomCanvas.width=this.canvas.width,this.zoomCanvas.height=this.canvas.height}init(){this.isInitialized||(this.isInitialized=!0,this.resizeAll(),this.updateOriginalCanvas(),t&&!e&&(this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur()),this.setupEvents(),this.setupScrollAnimation(),this.render())}startVideoAnimation(){if(!this.isVideo)return;const t=e=>{this.isVideoPlaying&&e-this.lastVideoUpdate>this.videoFrameRate&&(this.lastVideoUpdate=e,this.updateVideoFrame()),requestAnimationFrame(t)};requestAnimationFrame(t)}drawImageCover(t,e,i,n){const o=e.videoWidth/e.videoHeight;let s,a,r,l;i/n>o?(s=i,a=i/o,r=0,l=(n-a)/2):(a=n,s=n*o,r=(i-s)/2,l=0),t.clearRect(0,0,i,n),t.drawImage(e,r,l,s,a)}applyBlur(){if(!this.blurCtx||!this.originalCtx)return;if(this.isBlurWorking)return;this.isBlurWorking=!0,this.isBlurDone=!1;const t=this.blurCanvas.width,e=this.blurCanvas.height,i=Math.max(0,Math.floor(this.settings.blurRadius)),n=this.originalCtx.getImageData(0,0,t,e),o=n.data,s=t,a=e,r=s+1,l=a+1;if(this.blurCtx.putImageData(n,0,0),0===i)return this.isBlurWorking=!1,void(this.isBlurDone=!0);const h=r*l,c=new Float64Array(h),d=new Float64Array(h),u=new Float64Array(h);let m=1;const g=Math.max(8,Math.floor(2e5/s)),f=(t,e,i,n,o)=>{const s=i*r+e,a=i*r+(n+1),l=(o+1)*r+e;return t[(o+1)*r+(n+1)]-t[a]-t[l]+t[s]},v=this.blurCtx.createImageData(s,a),p=v.data,w=Math.max(4,Math.floor(1e5/s)),C=this,x=()=>{const t=Math.min(a,m+g-1);for(let e=m;e<=t;e++){let t=0,i=0,n=0;const a=(e-1)*s*4;for(let l=1;l<=s;l++){const s=a+4*(l-1);t+=o[s],i+=o[s+1],n+=o[s+2];const h=e*r+l,m=(e-1)*r+l;c[h]=c[m]+t,d[h]=d[m]+i,u[h]=u[m]+n}}m=t+1,m<=a?setTimeout(x,0):y(0)};function y(t){const e=Math.min(a-1,t+w-1);for(let n=t;n<=e;n++)for(let t=0;t<s;t++){const e=Math.max(0,t-i),r=Math.min(s-1,t+i),l=Math.max(0,n-i),h=Math.min(a-1,n+i),m=(r-e+1)*(h-l+1),g=f(c,e,l,r,h),v=f(d,e,l,r,h),w=f(u,e,l,r,h),C=4*(n*s+t);p[C]=Math.round(g/m),p[C+1]=Math.round(v/m),p[C+2]=Math.round(w/m),p[C+3]=o[4*(n*s+t)+3]}try{C.blurCtx.putImageData(v,0,0,0,t,s,e-t+1)}catch(t){C.blurCtx.putImageData(v,0,0)}e<a-1?setTimeout(()=>y(e+1),0):(C.isBlurWorking=!1,C.isBlurDone=!0)}setTimeout(x,0)}renderPixelated(t){const e=this.canvas,i=this.ctx,n=Math.max(1,Math.floor(e.width/Math.max(1,t))),o=Math.max(1,Math.floor(e.height/Math.max(1,t)));this.pixelCanvas.width===n&&this.pixelCanvas.height===o||(this.pixelCanvas.width=n,this.pixelCanvas.height=o),this.pixelCtx.clearRect(0,0,this.pixelCanvas.width,this.pixelCanvas.height),this.pixelCtx.drawImage(this.originalCanvas,0,0,this.originalCanvas.width,this.originalCanvas.height,0,0,this.pixelCanvas.width,this.pixelCanvas.height),i.imageSmoothingEnabled=!1,i.clearRect(0,0,e.width,e.height),i.drawImage(this.pixelCanvas,0,0,this.pixelCanvas.width,this.pixelCanvas.height,0,0,e.width,e.height)}drawGrid(){if(!t&&e)return;if(!this.blurCanvas||!this.isBlurDone)return;const{cellSize:i,effectRadius:n,zoomFactor:o,zoomRadius:s}=this.settings,a=this.mouse.x,r=this.mouse.y;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderPixelated(this.pixelSize.value);const l=Math.max(0,Math.floor((a-n)/i)),h=Math.min(Math.ceil(this.canvas.width/i),Math.ceil((a+n)/i)),c=Math.max(0,Math.floor((r-n)/i)),d=Math.min(Math.ceil(this.canvas.height/i),Math.ceil((r+n)/i)),u=n*n,m=s*s;for(let t=c;t<d;t++)for(let e=l;e<h;e++){const o=e*i,s=t*i,l=o+i/2,h=s+i/2,c=(l-a)*(l-a)+(h-r)*(h-r);if(c<u){this.ctx.save(),this.ctx.globalCompositeOperation="source-over",this.ctx.drawImage(this.blurCanvas,o,s,i,i,o,s,i,i),this.ctx.restore();const t=.05*(1-Math.sqrt(c)/n);this.ctx.save(),this.ctx.globalCompositeOperation="lighten",this.ctx.fillStyle=`rgba(244,244,244,${Math.max(.02,t)})`,this.ctx.fillRect(o,s,i,i),this.ctx.restore()}}for(let t=c;t<d;t++)for(let e=l;e<h;e++){const n=e*i,l=t*i,h=n+i/2,c=l+i/2,d=(h-a)*(h-a)+(c-r)*(c-r);if(d<m){const t=Math.sqrt(d),e=1+(o-1)*Math.max(0,1-t/s),h=i/e,c=i,u=n+i/2-(a-(n+i/2))*(e-1)-h/2,m=l+i/2-(r-(l+i/2))*(e-1)-h/2,g=Math.max(0,Math.min(this.originalCanvas.width-h,u)),f=Math.max(0,Math.min(this.originalCanvas.height-h,m));this.ctx.save(),this.ctx.globalCompositeOperation="source-over",this.ctx.drawImage(this.originalCanvas,g,f,h,h,n,l,c,c),this.ctx.restore()}}}render(){this.isInitialized&&(this.isPixelationComplete?(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.originalCanvas,0,0),t&&!e&&this.isGridActive&&this.drawGrid()):(this.renderPixelated(this.pixelSize.value),t&&!e&&this.isGridActive&&this.drawGrid()),requestAnimationFrame(()=>this.render()))}setupScrollAnimation(){gsap.to(this.pixelSize,{value:1,scrollTrigger:{trigger:".about",start:ABOUTCONFIG.StartAnimPixel,end:ABOUTCONFIG.endAnim,scrub:1,ease:"sine.inOut",onComplete:()=>{this.isPixelationComplete=!0}}})}setupEvents(){!t&&e||(this.media.addEventListener("mousemove",t=>{const e=this.canvas.getBoundingClientRect();this.mouse.x=t.clientX-e.left,this.mouse.y=t.clientY-e.top,this.isGridActive=!0}),this.media.addEventListener("mouseleave",()=>{this.isGridActive=!1}))}}setTimeout(function(){document.querySelectorAll(".about_canva").forEach(t=>{new i(t)})},500)}),width>750&&document.addEventListener("DOMContentLoaded",()=>{const t={squareSize:40,fillColor:"#000000",initialFillRatio:.3,animationDuration:25,staggerDelay:1};width<=750&&(t.squareSize=20);const e=document.querySelector(".feedback_btn"),i=e.querySelector(".btn_canvas"),n=i.getContext("2d");let o=[],s=!1;function a(){const n=e.offsetWidth,s=e.offsetHeight;i.width=n,i.height=s;const a=t.squareSize*parseFloat(getComputedStyle(document.documentElement).fontSize);const l=Math.ceil(n/a),h=Math.ceil(s/a);o=[];for(let e=0;e<h;e++)for(let i=0;i<l;i++)o.push({x:i*a,y:e*a,width:a,height:a,filled:Math.random()<t.initialFillRatio,initialFilled:!1,progress:0});o.forEach(t=>{t.initialFilled=t.filled}),r()}function r(){n.clearRect(0,0,i.width,i.height),o.forEach(e=>{(e.filled||e.progress>0)&&(n.fillStyle=t.fillColor,n.globalAlpha=e.filled?1:e.progress,n.fillRect(Math.round(e.x),Math.round(e.y),Math.round(e.width)+1,Math.round(e.height)+1),n.globalAlpha=1)})}async function l(e,i,n){return new Promise(o=>{setTimeout(()=>{const n=performance.now();requestAnimationFrame(function s(a){const l=a-n,h=Math.min(l/t.animationDuration,1);e.progress=i?h:1-h,r(),h<1?requestAnimationFrame(s):(e.filled=i,e.progress=0,o())})},n)})}a(),e.addEventListener("mouseenter",async function(){s=!0;const e=[...o].sort(()=>Math.random()-.5);for(let i=0;i<e.length&&s;i++){const n=e[i];n.filled||await l(n,!0,i*t.staggerDelay)}}),e.addEventListener("mouseleave",async function(){s=!1;const e=[...o].sort(()=>Math.random()-.5);for(let i=0;i<e.length&&!s;i++){const n=e[i];n.filled&&!n.initialFilled&&await l(n,!1,i*t.staggerDelay)}}),window.addEventListener("resize",a)}),document.addEventListener("DOMContentLoaded",()=>{new ScrollMagic.Controller;const t=window.innerWidth>820,e=window.innerWidth<=820;function i(t,e=150){let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>t(...n),e)}}function n(t,e,i,n){const o=e.naturalWidth/e.naturalHeight;let s,a,r,l;i/n>o?(s=i,a=i/o,r=0,l=(n-a)/2):(a=n,s=n*o,r=(i-s)/2,l=0),t.clearRect(0,0,i,n),t.drawImage(e,r,l,s,a)}class o{constructor(e){this.media=e,this.img=e.querySelector("img"),this.canvas=e.querySelector(".grid-canvas-case"),this.ctx=this.canvas.getContext("2d"),this.pixelSize=40,this.pixelCanvas=document.createElement("canvas"),this.pixelCtx=this.pixelCanvas.getContext("2d"),this.isGridActive=!1,this.mouse={x:-1e3,y:-1e3},this.originalCanvas=document.createElement("canvas"),this.originalCtx=this.originalCanvas.getContext("2d"),this.blurCanvas=document.createElement("canvas"),this.blurCtx=this.blurCanvas.getContext("2d"),this.zoomCanvas=document.createElement("canvas"),this.zoomCtx=this.zoomCanvas.getContext("2d"),this.rafId=null,this.isInitialized=!1,this.isBlurWorking=!1,this.isBlurDone=!1,this.settings={cellSize:54,effectRadius:120,blurRadius:120,fillColor:"rgba(244,244,244,0.9)",zoomFactor:5,zoomRadius:120,zoomTransition:.25},this.visibilityObserver=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(this.visibilityObserver.unobserve(this.media),this.img.complete?this.init():this.img.addEventListener("load",()=>this.init(),{once:!0}))})},{threshold:.05,rootMargin:"400px"});const o=this.media.getBoundingClientRect();o.top<window.innerHeight+400&&o.bottom>-400&&this.img.complete?this.init():this.visibilityObserver.observe(this.media),this._onResize=i(()=>{this.isInitialized&&(this.resizeCanvas(),this.originalCanvas.width=this.canvas.width,this.originalCanvas.height=this.canvas.height,n(this.originalCtx,this.img,this.originalCanvas.width,this.originalCanvas.height),t&&!isTouchDevice&&(this.blurCanvas.width=this.canvas.width,this.blurCanvas.height=this.canvas.height,this.zoomCanvas.width=this.canvas.width,this.zoomCanvas.height=this.canvas.height,this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur()),this.requestRender())},200),window.addEventListener("resize",this._onResize)}resizeCanvas(){this.canvas.width=this.media.offsetWidth,this.canvas.height=this.media.offsetHeight}init(){this.isInitialized||(this.isInitialized=!0,this.resizeCanvas(),this.originalCanvas.width=this.canvas.width,this.originalCanvas.height=this.canvas.height,n(this.originalCtx,this.img,this.originalCanvas.width,this.originalCanvas.height),t&&!isTouchDevice&&(this.blurCanvas.width=this.canvas.width,this.blurCanvas.height=this.canvas.height,this.zoomCanvas.width=this.canvas.width,this.zoomCanvas.height=this.canvas.height,this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur()),this.setupEvents(),this.requestRender())}setupEvents(){!t&&isTouchDevice||(this._onMouseMove=t=>{const e=this.canvas.getBoundingClientRect();this.mouse.x=t.clientX-e.left,this.mouse.y=t.clientY-e.top,this.isGridActive=!0,this.requestRender()},this._onMouseLeave=()=>{this.isGridActive=!1,this.requestRender()},this.media.addEventListener("mousemove",this._onMouseMove),this.media.addEventListener("mouseleave",this._onMouseLeave))}applyBlur(){if(!this.blurCtx||!this.originalCtx)return;if(this.isBlurWorking)return;this.isBlurWorking=!0,this.isBlurDone=!1;const t=this.blurCanvas.width,e=this.blurCanvas.height,i=Math.max(0,Math.floor(this.settings.blurRadius)),n=this.originalCtx.getImageData(0,0,t,e),o=n.data,s=t,a=e,r=s+1,l=a+1;if(this.blurCtx.putImageData(n,0,0),0===i)return this.isBlurWorking=!1,void(this.isBlurDone=!0);const h=r*l,c=new Float64Array(h),d=new Float64Array(h),u=new Float64Array(h);let m=1;const g=Math.max(8,Math.floor(2e5/s)),f=()=>{const t=Math.min(a,m+g-1);for(let e=m;e<=t;e++){let t=0,i=0,n=0;const a=(e-1)*s*4;for(let l=1;l<=s;l++){const s=a+4*(l-1);t+=o[s],i+=o[s+1],n+=o[s+2];const h=e*r+l,m=(e-1)*r+l;c[h]=c[m]+t,d[h]=d[m]+i,u[h]=u[m]+n}}m=t+1,m<=a?setTimeout(f,0):y(0)},v=(t,e,i,n,o)=>{const s=i*r+e,a=i*r+(n+1),l=(o+1)*r+e;return t[(o+1)*r+(n+1)]-t[a]-t[l]+t[s]},p=this.blurCtx.createImageData(s,a),w=p.data,C=Math.max(4,Math.floor(1e5/s)),x=this;function y(t){const e=Math.min(a-1,t+C-1);for(let n=t;n<=e;n++)for(let t=0;t<s;t++){const e=Math.max(0,t-i),r=Math.min(s-1,t+i),l=Math.max(0,n-i),h=Math.min(a-1,n+i),m=(r-e+1)*(h-l+1),g=v(c,e,l,r,h),f=v(d,e,l,r,h),p=v(u,e,l,r,h),C=4*(n*s+t);w[C]=Math.round(g/m),w[C+1]=Math.round(f/m),w[C+2]=Math.round(p/m),w[C+3]=o[4*(n*s+t)+3]}try{x.blurCtx.putImageData(p,0,0,0,t,s,e-t+1)}catch(t){x.blurCtx.putImageData(p,0,0)}e<a-1?setTimeout(()=>y(e+1),0):(x.isBlurWorking=!1,x.isBlurDone=!0)}setTimeout(f,0)}renderPixelated(t){const e=this.ctx,i=this.canvas;if(!this.originalCanvas)return void(this.img&&(e.clearRect(0,0,i.width,i.height),e.drawImage(this.img,0,0,i.width,i.height)));const n=Math.max(1,Math.floor(i.width/Math.max(1,t))),o=Math.max(1,Math.floor(i.height/Math.max(1,t)));this.pixelCanvas.width===n&&this.pixelCanvas.height===o||(this.pixelCanvas.width=n,this.pixelCanvas.height=o),this.pixelCtx.clearRect(0,0,this.pixelCanvas.width,this.pixelCanvas.height),this.pixelCtx.drawImage(this.originalCanvas,0,0,this.originalCanvas.width,this.originalCanvas.height,0,0,this.pixelCanvas.width,this.pixelCanvas.height),e.imageSmoothingEnabled=!1,e.clearRect(0,0,i.width,i.height),e.drawImage(this.pixelCanvas,0,0,this.pixelCanvas.width,this.pixelCanvas.height,0,0,i.width,i.height)}drawGrid(){if(!t&&isTouchDevice)return;if(!this.blurCanvas||!this.isBlurDone)return;const{cellSize:e,effectRadius:i,zoomFactor:n,zoomRadius:o,zoomTransition:s}=this.settings,a=this.mouse.x,r=this.mouse.y,l=Math.max(0,Math.floor((a-i)/e)),h=Math.min(Math.ceil(this.canvas.width/e),Math.ceil((a+i)/e)),c=Math.max(0,Math.floor((r-i)/e)),d=Math.min(Math.ceil(this.canvas.height/e),Math.ceil((r+i)/e)),u=i*i,m=o*o;for(let t=c;t<d;t++)for(let n=l;n<h;n++){const o=n*e,s=t*e,l=o+e/2,h=s+e/2,c=(l-a)*(l-a)+(h-r)*(h-r);if(c<u){this.ctx.drawImage(this.blurCanvas,o,s,e,e,o,s,e,e);const t=.01*(1-Math.sqrt(c)/i);this.ctx.fillStyle=`rgba(244,244,244,${t.toFixed(3)})`,this.ctx.fillRect(o,s,e,e)}}for(let t=c;t<d;t++)for(let i=l;i<h;i++){const l=i*e,h=t*e,c=l+e/2,d=h+e/2,u=(c-a)*(c-a)+(d-r)*(d-r);if(u<m){const t=1-Math.sqrt(u)/o,i=1+(n-1)*t,c=e/i,d=e,m=l+e/2-(a-(l+e/2))*(i-1)-c/2,g=h+e/2-(r-(h+e/2))*(i-1)-c/2,f=Math.max(0,Math.min(this.originalCanvas.width-c,m)),v=Math.max(0,Math.min(this.originalCanvas.height-c,g));this.zoomCtx.clearRect(0,0,this.zoomCanvas.width,this.zoomCanvas.height),this.zoomCtx.drawImage(this.originalCanvas,f,v,c,c,l,h,d,d);const p=Math.min(1,t/s);this.ctx.globalAlpha=p,this.ctx.drawImage(this.zoomCanvas,l,h,d,d,l,h,d,d),this.ctx.globalAlpha=1}}}requestRender(){this.rafId||(this.rafId=requestAnimationFrame(()=>{this.renderPixelated(this.pixelSize),t&&!isTouchDevice&&this.isGridActive&&this.drawGrid(),this.rafId=null}))}stop(){window.removeEventListener("resize",this._onResize),this.media&&this._onMouseMove&&(this.media.removeEventListener("mousemove",this._onMouseMove),this.media.removeEventListener("mouseleave",this._onMouseLeave)),this.visibilityObserver&&this.visibilityObserver.disconnect(),this.rafId&&cancelAnimationFrame(this.rafId)}setPixelSize(t){this.pixelSize=t,this.requestRender()}}const s=document.querySelector(".case__soft"),a=Array.from(s.querySelectorAll(".item")),r=document.querySelector(".load-more");let l=3;function h(){e?(a.forEach((t,e)=>{e<l?(t.classList.add("item--visible"),t.style.display="flex"):(t.classList.remove("item--visible"),t.style.display="none")}),l>=a.length?r.style.display="none":r.style.display="flex"):(a.forEach((t,e)=>{t.classList.add("item--visible"),t.style.display="flex"}),r.style.display="none")}h();const c=[];let d,u=0;function m(){if(e)return;const i=s.querySelectorAll(".item--visible");d=a.length-l,$(".case-count").text(`[${d}]`),i.forEach(n=>{const a=n.querySelector(".media");if(!a._effectInitialized){const n=new o(a);c.push(n),a._effectInitialized=!0;const l=n.img,h=()=>{u++,l.removeEventListener("load",h),u===i.length&&function(){if(e)return;const i=s.querySelectorAll(".item--visible");g&&(g.scrollTrigger.kill(),g.kill(),g=null);let n;n=t?window.innerHeight*(i.length-1):window.innerHeight*(i.length-1)*3;g=gsap.timeline({scrollTrigger:{trigger:".case",start:"top top",end:()=>`+=${n}`,scrub:.5,pin:!0,onUpdate:t=>{t.progress>=.6&&t.progress<.9?r.classList.add("animate"):r.classList.remove("animate")}}}),i.forEach((i,n)=>{const o=c.find(t=>t.media===i.querySelector(".media"));let s,a=0;a=i.classList.contains("small_case")?-260:-220,s=isTouchDevice&&!e&&window.innerWidth>1024?30:isTouchDevice&&!e&&window.innerWidth<=1024&&window.innerHeight>=1e3?130:0;const r=1,l=.5,h=t?.3:.6;t||(a=-240),window.innerWidth<500&&(a=-250),window.innerWidth<821&&window.innerWidth>=750&&(a=-250);let d=null;const u=gsap.timeline().fromTo(i,{yPercent:s,opacity:1},{yPercent:a,opacity:1,duration:r}).to({size:40},{size:1,duration:l,ease:"power2.out",onUpdate(){const t=Math.round(this.targets()[0].size);t!==d&&(d=t,o.pixelSize=t,o.requestRender())}},0);g.add(u,n*h)})}()};l.complete?setTimeout(()=>h(),0):l.addEventListener("load",h)}})}let g=null;r.addEventListener("click",()=>{if(e){lenis.scroll;l+=3,h(),m(),lenis.emit(),lenis.resize(),lenis.raf(0);const t=a.length-l;$(".case-count").text(`[${t}]`)}}),$(window).on("load",function(){l+=3;const t=a.length-l;$(".case-count").text(`[${t}]`)}),window.addEventListener("resize",i(()=>{window.innerWidth<=820!==e?window.location.reload():g&&g.scrollTrigger&&g.scrollTrigger.refresh()},250)),m(),window.addEventListener("beforeunload",()=>{c.forEach(t=>t.stop&&t.stop())});let f=Array.from(document.querySelectorAll("[data-circular-text]"));const v={size:12,radius:53,showPath:!0,spread:!0,inside:!1,texts:[]};f.forEach((t,e)=>{v.texts[e]=t.dataset.circularText||"Your text • ";const i=t.querySelector(".circlePath");if(i){i.id=`circlePath${e}`;const n=t.querySelector(".textPath");n&&(n.setAttribute("href",`#${i.id}`),n.textContent=v.texts[e])}}),f.forEach((t,e)=>{const i=t.querySelector(".circlePath"),n=t.querySelector(".textPath");if(!i||!n)return;const o=`\n        M ${65-v.radius}, 65\n        a ${v.radius},${v.radius} 0 1,${v.inside?0:1} ${2*v.radius},0\n        a ${v.radius},${v.radius} 0 1,${v.inside?0:1} -${2*v.radius},0\n      `;i.setAttribute("d",o),n.textContent=v.texts[e],i.style.setProperty("--show",v.showPath?1:0),v.spread?n.setAttribute("textLength",2*Math.PI*v.radius*.95):n.removeAttribute("textLength")})});const video=document.querySelector(".showreel__video");if(!isTouchDevice&&document.querySelector(".cursor")){let s,a;gsap.set(".cursor",{xPercent:-50,yPercent:-50}),window.innerWidth>820?(s=40,a=20):(s=20,a=10);let r=!1,l=0,h=0,c=null;const d=document.querySelector(".cursor"),u=document.querySelector(".default_text"),m=document.querySelector(".showreel"),g=$(d),f=$(u),v=$(m);function moveCursor(t,e){gsap.to(g,{x:t,y:e,duration:.1,ease:"power1.out"})}function updateVideoCursor(){if(!video)return;const t=!video.paused&&!video.ended;g.stop(!0).animate({width:`${s}rem`,height:`${s}rem`},200),g.find(".arrow").css("scale","0"),g.find(".pause").css("scale",t?"1":"0"),g.find(".play").css("scale",t?"0":"1"),f.stop(!0,!0).fadeIn(200).text(t?ConFigNames.pause:ConFigNames.play)}function resetCursor(){g.find("svg").css("scale","0"),f.stop(!0,!0).fadeOut(200),g.stop(!0).animate({width:`${a}rem`,height:`${a}rem`},200)}function checkCursorPosition(t,e){if(!m)return;const i=m.getBoundingClientRect(),n=t>=i.left-2&&t<=i.right+2&&e>=i.top-2&&e<=i.bottom+2;c&&clearTimeout(c),n&&!r?c=setTimeout(()=>{r=!0,updateVideoCursor()},50):!n&&r&&(c=setTimeout(()=>{r=!1,resetCursor()},50))}$("button").on("mouseover",function(t){g.stop(!0).animate({width:`${s}rem`,height:`${s}rem`},200)}),$("button").on("mouseout",function(t){g.stop(!0).animate({width:`${a}rem`,height:`${a}rem`},200),g.find("svg").css("scale","0")}),$(document).on("mousemove",function(t){l=t.clientX,h=t.clientY,moveCursor(l,h),checkCursorPosition(l,h)}).on("mouseenter","a",function(){const t=$(this).attr("href")||"";f.stop(!0,!0).fadeIn(200),g.stop(!0).animate({width:`${s}rem`,height:`${s}rem`},200),t.includes("tel")?(f.text(ConFigNames.phone),g.find(".phone").css("scale","1").siblings("svg").not(".arrow, .phone").css("scale","0")):t.includes("mail")?(f.text(ConFigNames.email),g.find(".mail").css("scale","1").siblings("svg").not(".arrow, .mail").css("scale","0")):t.includes("#")?(f.text(""),g.find(".arrow").css("scale","0").siblings("svg").not(".arrow").css("scale","0")):(f.text(""),g.find(".arrow").css("scale","1").siblings("svg").not(".arrow").css("scale","0"))}).on("mouseleave","a",function(){r?updateVideoCursor():resetCursor()}),v.on("click",function(t){video&&(t.preventDefault(),video.paused||video.ended?video.play().catch(t=>console.error("Video play error:",t)):video.pause(),updateVideoCursor())}),$(document).on("mouseleave",function(){r=!1,resetCursor()}),$(window).on("scroll resize",function(){checkCursorPosition(l,h)}),$(function(){resetCursor()}),$(window).on("resize",function(){isTouchDevice&&($(document).off("mousemove mouseenter mouseleave"),$(window).off("scroll resize"),c&&clearTimeout(c))})}else $(".muteor").on("click",function(){console.log(1),video&&(video.muted=!video.muted,$(this).find(".mute").toggle(!video.muted),$(this).find(".sound").toggle(video.muted))});class BodyGrid{constructor(t={}){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.settings={baseSizeRem:54,activationRadiusRem:120,trailLifetime:100,gridColor:{r:39,g:39,b:39},borderWidthRem:1,disappearChance:.25},this.zonesSelector=t.zonesSelector||".feedback, footer",this.scrollEl=this.resolveScrollEl(t.scrollContainer),this.cells=new Map,this.mouse={xRem:-1e3,yRem:-1e3,inside:!1,lastClientX:0,lastClientY:0},this.lastMouseMoveTime=performance.now(),this.idleTimeout=100,this.updateRemSize(),this.initCanvas(),this.addEvents(),this.animate()}resolveScrollEl(t){if(!t)return window;if(t instanceof Element)return t;return document.querySelector(t)||window}updateRemSize(){this.remPx=parseFloat(getComputedStyle(document.documentElement).fontSize)||16}getScrollXpx(){return this.scrollEl===window?window.scrollX||0:this.scrollEl.scrollLeft||0}getScrollYpx(){return this.scrollEl===window?window.scrollY||0:this.scrollEl.scrollTop||0}getScrollXRem(){return this.getScrollXpx()/this.remPx}getScrollYRem(){return this.getScrollYpx()/this.remPx}getViewWidthPx(){return this.scrollEl===window?window.innerWidth:this.scrollEl.clientWidth}getViewHeightPx(){return this.scrollEl===window?window.innerHeight:this.scrollEl.clientHeight}getViewWidthRem(){return this.getViewWidthPx()/this.remPx}getViewHeightRem(){return this.getViewHeightPx()/this.remPx}initCanvas(){this.canvas.style.position="fixed",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="-1",document.body.appendChild(this.canvas),this.resizeCanvas(),window.addEventListener("resize",()=>{this.updateRemSize(),this.resizeCanvas()})}resizeCanvas(){const t=window.devicePixelRatio||1;this.canvas.width=Math.floor(window.innerWidth*t),this.canvas.height=Math.floor(window.innerHeight*t),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(t,t),this.pixelRatio=t}addEvents(){document.addEventListener("mousemove",t=>{this.lastMouseMoveTime=performance.now(),this.mouse.lastClientX=t.clientX,this.mouse.lastClientY=t.clientY;const e=t.clientX+this.getScrollXpx(),i=t.clientY+this.getScrollYpx();this.mouse.xRem=e/this.remPx,this.mouse.yRem=i/this.remPx,this.mouse.inside=!0,this.updateHoverColorAtPoint(t.clientX,t.clientY)},{passive:!0});const t=()=>{if(!this.mouse.inside)return;const t=this.getScrollYpx(),e=this.mouse.lastClientY+t;let i=!1;document.querySelectorAll(this.zonesSelector).forEach(n=>{const o=n.getBoundingClientRect(),s=o.top+t,a=o.bottom+t;e>=s&&e<=a&&(i=!0)}),this.settings.gridColor=i?{r:90,g:69,b:199}:{r:39,g:39,b:39}};this.scrollEl===window?window.addEventListener("scroll",t,{passive:!0}):this.scrollEl.addEventListener("scroll",t,{passive:!0}),document.addEventListener("mouseout",()=>{this.mouse.xRem=-1e3,this.mouse.yRem=-1e3,this.mouse.inside=!1,this.settings.gridColor={r:39,g:39,b:39}},{passive:!0})}updateHoverColorAtPoint(t,e){if(!this.mouse.inside)return void(this.settings.gridColor={r:39,g:39,b:39});let i=document.elementsFromPoint(t,e).some(t=>t.closest(this.zonesSelector));if(!i){const t=this.getScrollYpx(),n=e+t;document.querySelectorAll(this.zonesSelector).forEach(e=>{const o=e.getBoundingClientRect(),s=o.top+t,a=o.bottom+t;n>=s&&n<=a&&(i=!0)})}this.settings.gridColor=i?{r:90,g:69,b:199}:{r:39,g:39,b:39}}isIdle(){return performance.now()-this.lastMouseMoveTime>this.idleTimeout}updateCells(){const t=performance.now(),e=this.settings.activationRadiusRem,i=this.settings.baseSizeRem;if(this.mouse.inside&&!this.isIdle()){const n=this.mouse.xRem,o=this.mouse.yRem,s=Math.floor((n-e)/i),a=Math.floor((n+e)/i),r=Math.floor((o-e)/i),l=Math.floor((o+e)/i);for(let h=r;h<=l;h++)for(let r=s;r<=a;r++){const s=n-(r*i+i/2),a=o-(h*i+i/2);if(s*s+a*a<=e*e){const e=`${r}_${h}`;this.cells.set(e,{lastActive:t,life:this.settings.trailLifetime})}}}for(let[t,e]of this.cells)e.life-=16,e.life<=0&&(Math.random()<this.settings.disappearChance?this.cells.delete(t):e.life=50+50*Math.random())}draw(){const t=this.ctx,e=this.settings.baseSizeRem,i=this.getScrollXRem(),n=this.getScrollYRem(),o=this.getViewWidthRem(),s=this.getViewHeightRem();t.clearRect(0,0,this.canvas.width,this.canvas.height),t.strokeStyle=`rgb(${this.settings.gridColor.r},${this.settings.gridColor.g},${this.settings.gridColor.b})`,t.lineWidth=this.settings.borderWidthRem*this.remPx/this.pixelRatio;const a=Math.floor(i/e)-1,r=Math.floor((i+o)/e)+1,l=Math.floor(n/e)-1,h=Math.floor((n+s)/e)+1,c=this.remPx;for(let o=l;o<=h;o++)for(let s=a;s<=r;s++){const a=`${s}_${o}`;if(!this.cells.has(a))continue;const r=(s*e-i)*c,l=(o*e-n)*c,h=e*c;t.strokeRect(r,l,h,h)}}animate(){this.updateCells(),this.draw(),requestAnimationFrame(()=>this.animate())}}window.innerWidth>1024&&!isTouchDevice&&document.addEventListener("DOMContentLoaded",()=>{new BodyGrid({zonesSelector:".feedback, footer"})}),document.addEventListener("DOMContentLoaded",()=>{const t={squareSize:54,gap:0,fillColor:"#442CBF",bgColor:"#000000",animationDuration:800,widthView:1920};function e(e){return e*(window.innerWidth/t.widthView)}window.innerWidth<=750&&(t.widthView=375,t.squareSize=20,t.animationDuration=500);const i=document.getElementById("feedback-grid-canvas"),n=i.getContext("2d");let o=[],s=[],a=0;function r(){const r=document.querySelector(".feedback__top"),h=r.clientWidth,c=r.clientHeight,d=window.devicePixelRatio||1;i.style.width=h+"px",i.style.height=c+"px",i.width=h*d,i.height=c*d,n.scale(d,d);const u=e(t.squareSize),m=e(t.gap),g=Math.ceil(h/(u+m)),f=Math.ceil(c/(u+m));o=[];for(let t=0;t<f;t++)for(let e=0;e<g;e++)o.push({x:0+e*(u+m),y:0+t*(u+m),width:u,height:u,filled:!1});s=[...Array(o.length).keys()],function(t){for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}}(s),a=0,l()}function l(){n.clearRect(0,0,i.width,i.height),n.imageSmoothingEnabled=!1,n.fillStyle=t.bgColor,n.fillRect(0,0,i.width,i.height),o.forEach(e=>{const i=e.x,o=e.y,s=e.width;n.fillStyle=e.filled?t.fillColor:t.bgColor,n.fillRect(i,o,s+.5,s+.5)})}const h=new ScrollMagic.Controller;let c;new ScrollMagic.Scene({triggerElement:".feedback",duration:t.animationDuration,triggerHook:1}).on("progress",t=>{!function(t){if(t<a)for(let e=a-1;e>=t;e--)e>=0&&e<s.length&&(o[s[e]].filled=!1);else for(let e=a;e<t;e++)e>=0&&e<s.length&&(o[s[e]].filled=!0);a=t,l()}(Math.floor(t.progress*o.length))}).addTo(h),r(),window.addEventListener("resize",()=>{clearTimeout(c),c=setTimeout(()=>{window.innerWidth<=750?(t.widthView=375,t.squareSize=20,t.animationDuration=500):(t.widthView=1920,t.squareSize=54,t.animationDuration=1e3),r(),h.update()},100)})}),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});const tippyInstances=[];$(".input__wrap p").each(function(t){const e=$(this).parents(".input__wrap").find("input").attr("name"),i=$(this).attr("data-tippy"),n=tippy(this,{content:`${i}`,placement:"top",animation:"fade",arrow:!0,name:e,theme:"custom",trigger:"mouseenter manual"});tippyInstances.push(n)}),$(".feedback_btn").on("click",function(t){let e={};$(".inputs input").each(function(){const t=$(this).attr("name");if(""==$(this).val())$(this).addClass("error"),tippyInstances.forEach(e=>{e.props.name==t&&e.show()});else{$(this).removeClass("error"),tippyInstances.forEach(e=>{e.props.name==t&&e.hide()});const i=$(this).attr("name");e[i]=$(this).val()}})}),document.addEventListener("DOMContentLoaded",()=>{const t={squareSize:54,gap:0,fillColor:"#000000",bgColor:"#F4F4F400",animationDuration:500,widthView:1920};width<=750&&(t.widthView=375,t.squareSize=20);const e=document.getElementById("grid-canvas-begin"),i=e.getContext("2d");let n=[],o=[],s=0;function a(){const a=document.querySelector(".main"),l=a.clientWidth,h=a.clientHeight,c=window.devicePixelRatio||1;e.width=Math.ceil(l*c),e.height=Math.ceil(h*c),i.setTransform(1,0,0,1,0,0),i.scale(c,c);const d=Math.round(t.squareSize*(window.innerWidth/t.widthView));const u=Math.ceil(l/d),m=Math.ceil(h/d),g=u*d,f=m*d;Math.floor((l-g)/2),Math.floor((h-f)/2);n=[];for(let t=0;t<=m;t++)for(let e=0;e<=u;e++)n.push({x:e*d,y:t*d,width:d+1,height:d+1,filled:!1});o=[...Array(n.length).keys()],function(t){for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}}(o),s=0,r()}function r(){i.clearRect(0,0,e.width,e.height),i.imageSmoothingEnabled=!1,i.fillStyle=t.bgColor,i.fillRect(0,0,e.width,e.height),n.forEach(e=>{i.fillStyle=e.filled?t.fillColor:t.bgColor,i.fillRect(e.x,e.y,e.width,e.height)})}const l=new ScrollMagic.Controller;let h;new ScrollMagic.Scene({triggerElement:".main",duration:t.animationDuration,triggerHook:0}).on("progress",t=>{!function(t){if(t<s)for(let e=s-1;e>=t;e--)e>=0&&e<o.length&&(n[o[e]].filled=!1);else for(let e=s;e<t;e++)e>=0&&e<o.length&&(n[o[e]].filled=!0);s=t,r()}(Math.floor(t.progress*n.length))}).addTo(l),a(),window.addEventListener("resize",()=>{clearTimeout(h),h=setTimeout(()=>{a(),l.update()},100)})}),document.addEventListener("DOMContentLoaded",()=>{const t={squareSize:54,fillColor:"#442CBF",bgColor:"#000000",animationDelay:500,fillDuration:1500,fadeDuration:2500,logoMoveDuration:1e3,targetLogoPosition:{x:40,y:53},sizeLogo:{width:200,height:50}};window.innerWidth<=820&&(t.squareSize=20);const e=document.querySelector(".preload-container"),i=document.querySelector(".preload-canvas"),n=i.getContext("2d"),o=e.querySelector("img"),s=document.querySelector("#js-cursor-progress span");let a,r,l=[],h={x:0,y:0},c=!1,d=!1;function u(){i.width=window.innerWidth,i.height=window.innerHeight;const e=Math.ceil(i.width/t.squareSize)+1,n=Math.ceil(i.height/t.squareSize)+1;l=[];for(let i=-1;i<n;i++)for(let n=-1;n<e;n++)l.push({x:n*t.squareSize,y:i*t.squareSize,width:t.squareSize,height:t.squareSize,state:"black",alpha:1});g(),m()}function m(){for(let t=l.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[l[t],l[e]]=[l[e],l[t]]}}function g(){n.clearRect(0,0,i.width,i.height),l.forEach(e=>{"black"===e.state?(n.fillStyle=t.bgColor,n.globalAlpha=e.alpha,n.fillRect(e.x,e.y,e.width,e.height)):"color"===e.state&&(n.fillStyle=t.fillColor,n.globalAlpha=e.alpha,n.fillRect(e.x,e.y,e.width,e.height))}),n.globalAlpha=1}function f(e){r||(r=e);const i=e-r,n=Math.min(i/t.fillDuration,1),o=Math.floor(n*l.length);for(let t=0;t<o;t++)t<l.length&&(l[t].state="color");if(document.querySelector(".cursor")){const t=Math.floor(99*n);s.textContent=`${t.toString().padStart(2,"0")}%`}g(),n<1?a=requestAnimationFrame(f):(r=null,m(),a=requestAnimationFrame(v))}function v(n){r||(r=n),i.style.background="transparent";const h=n-r,c=Math.min(h/t.fadeDuration,1),d=Math.min(h/t.logoMoveDuration,1);u=d,Math.pow(1-u,3);var u;setTimeout(()=>{o.animate({opacity:0},1e3)},1500),setTimeout(()=>{$(".main__body .stroke div").addClass("anim_stroke")},2e3);const m=Math.floor(c*l.length);for(let t=0;t<m;t++)t<l.length&&(l[t].state="transparent",l[t].alpha=1-c);document.querySelector(".cursor")&&s.parentElement&&(s.parentElement.style.opacity=1-c),g(),c<1?a=requestAnimationFrame(v):(e.style.transition="opacity 0.5s ease",e.style.opacity="0",setTimeout(()=>{e.remove()},500))}function p(){c&&d&&setTimeout(()=>{!function(){if(!c||!d)return;const e=(window.innerWidth-o.offsetWidth)/2,i=(window.innerHeight-o.offsetHeight)/2;h={x:e/parseFloat(getComputedStyle(document.documentElement).fontSize),y:i/parseFloat(getComputedStyle(document.documentElement).fontSize)},setTimeout(()=>{r=null,a=requestAnimationFrame(f)},t.animationDelay)}()},100)}function w(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}u(),function t(){if("complete"!==document.readyState)return void window.addEventListener("load",t);const e=document.querySelector(".priority-video"),i=document.querySelector(".about-parallax video");let n=!1;if(setTimeout(()=>{n=!0,c&&d||(console.warn("Assets loading timeout, starting animation anyway"),n&&(c=!0,d=!0,p()))},5e3),e)if(4===e.readyState)c=!0,p();else{try{e.load()}catch(t){console.log("Cannot manually load video:",t)}const t=()=>{c=!0,p(),e.removeEventListener("loadeddata",t),e.removeEventListener("error",t)};e.addEventListener("loadeddata",t),e.addEventListener("error",t),w()&&0===e.readyState&&(console.log("Mobile device detected, video not started loading"),setTimeout(()=>{c||(console.warn("Video not loading on mobile, continuing"),c=!0,p())},2e3))}else console.warn("Priority video not found, continuing"),c=!0,p();if(i)if(4===i.readyState)d=!0,p();else{try{i.load()}catch(t){console.log("Cannot manually load about video:",t)}const t=()=>{d=!0,p(),i.removeEventListener("loadeddata",t),i.removeEventListener("error",t)};i.addEventListener("loadeddata",t),i.addEventListener("error",t),w()&&0===i.readyState&&setTimeout(()=>{d||(console.warn("About video not loading on mobile, continuing"),d=!0,p())},2e3)}else console.warn("About video not found, continuing"),d=!0,p()}(),window.addEventListener("resize",()=>{a&&cancelAnimationFrame(a),u(),g()})}),$.fn.shuffleLetters=function(t){const e=$.extend({step:8,fps:60,text:"",duration:1e3,symbols:"!<>-_[]{}—=+*^?#%$@",symbolsProbability:1,callback:function(){}},t);function i(t){let e=[];for(let n=0;n<t.childNodes.length;n++){const o=t.childNodes[n];3===o.nodeType?e.push(o):1===o.nodeType&&(e=e.concat(i(o)))}return e}function n(t){return" "===t?"space":/[a-z]/.test(t)?"lowerLetter":/[A-Z]/.test(t)?"upperLetter":/[А-ЯЁ]/.test(t)?"rusUpperLetter":/[а-яё]/.test(t)?"rusLowerLetter":"symbol"}function o(t,i,o){if(o&&Math.random()<e.symbolsProbability&&e.symbols.length>0)return e.symbols[Math.floor(Math.random()*e.symbols.length)];let s=i.filter(e=>n(e)===t);return 0===s.length&&(s=i.filter(e=>"rusUpperLetter"===t||"rusLowerLetter"===t?/[А-Яа-яЁё]/.test(e):"upperLetter"===t||"lowerLetter"===t?/[A-Za-z]/.test(e):"symbol"===n(e))),s.length>0?s[Math.floor(Math.random()*s.length)]:""}return this.each(function(){const t=$(this);if(t.data("animated"))return;t.data("animated",!0);const s=t.html();t.data("originalHtml",s),t.find(".shuffle-wrapper").length||t.html('<span class="shuffle-wrapper">'+s+"</span>");const a=i(t.find(".shuffle-wrapper")[0]),r=[];a.forEach(t=>{r.push(...t.textContent.split(""))});const l=[];a.forEach(t=>{t.textContent.split("").forEach((e,i)=>{l.push({node:t,index:i,char:e,type:n(e)})})});const h=l.reduce((t,e,i)=>("space"!==e.type&&t.push(i),t),[]);let c=null;const d=1e3/e.fps;let u=0;requestAnimationFrame(function i(n){if(c||(c=n),n-u<d)return void requestAnimationFrame(i);u=n;const m=Math.min((n-c)/e.duration,1),g=a.map(t=>t.textContent.split("")),f=Math.floor(m*h.length),v=Math.random()<e.symbolsProbability*(1-m);h.forEach((t,e)=>{const i=l[t],n=a.indexOf(i.node);e<f?m>.95||Math.random()>.3?g[n][i.index]=i.char:g[n][i.index]=o(i.type,r,v):g[n][i.index]=o(i.type,r,!0)}),a.forEach((t,e)=>{t.textContent=g[e].join("")}),m<1?requestAnimationFrame(i):(t.data("animated",!1),t.html(s),e.callback(t))})})};const isFullEffect=window.innerWidth>820,timeOutShape=isFullEffect?400:200;!function(){gsap.registerPlugin(ScrollTrigger);const t=14,e=parseFloat(getComputedStyle(document.documentElement).fontSize),i=54*e,n=1*e,o="#272727",s=["#442CBF"],a=.16,r=.84,l={heart:[[1,6],[1,5],[1,4],[2,3],[3,2],[4,2],[5,3],[6,4],[7,4],[8,3],[9,2],[10,2],[11,3],[12,4],[12,5],[12,6],[11,7],[10,8],[9,9],[8,10],[7,11],[6,11],[5,10],[4,9],[3,8],[2,7]],sound:[[6,11],[5,10],[4,9],[3,8],[2,8],[1,8],[1,7],[1,6],[1,5],[2,5],[3,5],[4,4],[5,3],[6,2],[6,3],[6,4],[6,5],[6,6],[6,7],[6,8],[6,9],[6,10],[8,9],[9,9],[10,8],[10,7],[10,6],[10,5],[9,4],[8,4],[8,11],[9,11],[10,11],[11,10],[12,9],[12,8],[12,7],[12,6],[12,5],[12,4],[11,3],[10,2],[9,2],[8,2]],glass:[[6,7],[6,6],[7,6],[7,7],[0,6],[0,7],[1,5],[2,4],[3,3],[4,3],[5,2],[6,2],[7,2],[8,2],[9,3],[10,3],[11,4],[12,5],[13,6],[13,7],[12,8],[11,9],[10,10],[9,10],[8,11],[7,11],[6,11],[5,11],[4,10],[3,10],[2,9],[1,8]],cmile:[[1,8],[1,7],[1,6],[1,5],[2,4],[2,3],[3,2],[4,2],[5,1],[6,1],[7,1],[8,1],[9,2],[10,2],[11,3],[11,4],[12,5],[12,6],[12,7],[12,8],[11,9],[11,10],[10,11],[9,11],[8,12],[7,12],[6,12],[5,12],[4,11],[3,11],[2,10],[2,9],[5,6],[5,5],[5,4],[8,6],[8,5],[8,4],[4,8],[5,9],[6,9],[7,9],[8,9],[9,8]],kind:[[8,1],[7,1],[6,1],[5,1],[4,2],[3,2],[2,3],[2,4],[1,5],[1,6],[1,7],[1,8],[2,9],[2,10],[3,11],[4,11],[5,12],[6,12],[7,12],[8,12],[9,11],[10,11],[11,10],[11,9],[12,8],[12,7],[12,6],[12,5],[10,2],[10,3],[11,3],[9,4],[8,5],[7,6],[6,6],[6,7],[7,7],[6,4],[5,4],[4,5],[4,6],[4,7],[4,8],[5,9],[6,9],[7,9],[8,9],[9,8],[9,7]],creative:[[8,1],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7],[6,8],[5,7],[5,6],[5,5],[4,5],[6,5],[4,8],[3,7],[3,6],[3,5],[3,4],[2,3],[1,4],[1,5],[1,6],[1,7],[1,8],[1,9],[2,10],[3,11],[4,12],[5,12],[6,12],[7,12],[8,11],[9,11],[10,10],[11,9],[11,8],[12,7],[12,6],[12,5],[11,5],[10,6],[9,6],[9,7],[9,5],[9,4],[9,3],[9,2]],camera:[[1,2],[2,2],[3,2],[4,2],[5,2],[6,2],[7,2],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],[8,8],[8,9],[8,10],[8,11],[7,11],[6,11],[5,11],[4,11],[3,11],[2,11],[1,11],[1,10],[1,9],[1,8],[1,7],[1,6],[1,5],[1,4],[1,3],[9,5],[10,4],[11,3],[12,2],[12,3],[12,4],[12,5],[12,6],[12,7],[12,8],[12,9],[12,10],[12,11],[11,10],[10,9],[9,8]],photo:[[1,3],[2,3],[3,3],[4,3],[5,3],[6,3],[7,3],[8,3],[9,3],[10,3],[11,3],[12,3],[12,4],[12,5],[12,6],[12,7],[12,8],[12,9],[12,10],[12,11],[11,11],[10,11],[9,11],[8,11],[7,11],[6,11],[5,11],[4,11],[3,11],[2,11],[1,11],[1,10],[1,9],[1,8],[1,7],[1,6],[1,5],[1,4],[3,2],[4,2],[8,6],[9,6],[10,7],[10,8],[9,9],[8,9],[7,8],[7,7]],arrow:[[1,12],[1,11],[1,10],[2,9],[3,8],[4,7],[5,6],[6,5],[7,4],[8,3],[9,2],[10,1],[12,1],[11,0],[13,2],[12,3],[11,4],[10,5],[9,6],[8,7],[7,8],[6,9],[5,10],[4,11],[3,12],[2,12],[3,10],[10,3]]},h=Array.from(document.querySelectorAll(".items__line .item")),c=$(".items__line .item h3"),d=document.querySelector(".wrapper"),u=document.querySelector(".items__line");if(!h||0===h.length)return;let m=h.length;$(".items__line .item").each(function(){$(this).find(".total-slides").text(`0${m}`)});const g=h.map(t=>t.dataset.item),f=[],v=[];const p=document.getElementById("interactive-grid");h.forEach((e,s)=>{let a;0===s&&p?(a=p,d.contains(a)||d.appendChild(a)):(a=document.createElementNS("http://www.w3.org/2000/svg","svg"),a.classList.add("interactive-grid"),d.appendChild(a)),f.push(a);const{cellsGrid:r,allCells:l}=function(e){const s=[],a=[],r=n/2;for(let n=0;n<t;n++){s[n]=[];for(let o=0;o<t;o++){const t=document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttribute("x",o*i+r),t.setAttribute("y",n*i+r),t.setAttribute("width",i),t.setAttribute("height",i),t.setAttribute("fill","transparent"),e.appendChild(t),s[n][o]=t,a.push(t)}}for(let s=0;s<=t;s++){const a=document.createElementNS("http://www.w3.org/2000/svg","line"),l=s*i+r;a.setAttribute("x1",l),a.setAttribute("y1",r),a.setAttribute("x2",l),a.setAttribute("y2",t*i+r),a.setAttribute("stroke",o),a.setAttribute("stroke-width",n),e.appendChild(a)}for(let s=0;s<=t;s++){const a=document.createElementNS("http://www.w3.org/2000/svg","line"),l=s*i+r;a.setAttribute("x1",r),a.setAttribute("y1",l),a.setAttribute("x2",t*i+n),a.setAttribute("y2",l),a.setAttribute("stroke",o),a.setAttribute("stroke-width",n),e.appendChild(a)}return e.setAttribute("viewBox",`0 0 ${t*i+n} ${t*i+n}`),e.setAttribute("width",t*i+n),e.setAttribute("height",t*i+n),{cellsGrid:s,allCells:a}}(a);v.push({cellsGrid:r,allCells:l})});const w=Array.from(document.querySelectorAll(".interactive-grid"));function C(){const t=d.clientHeight;u.style.height=h.length*t+"px",h.forEach(e=>e.style.height=t+"px"),u.style.top="0px"}function x(e,i=0,n=!1){(i<0||i>=v.length)&&(i=0);const{cellsGrid:o,allCells:a}=v[i];if(n||!e)return gsap.killTweensOf(a),void gsap.set(a,{attr:{fill:"transparent"}});const r=l[e];if(!r)return gsap.killTweensOf(a),void gsap.set(a,{attr:{fill:"transparent"}});const h=r.map(([t,e])=>o[e]?.[t]).filter(Boolean);gsap.killTweensOf(a),gsap.set(a,{attr:{fill:"transparent"}}),gsap.to(h,{attr:{fill:s[0]},duration:.55,ease:"power2.out",stagger:{each:.03,from:"center",grid:[t,t]}})}gsap.set(w,{clipPath:"inset(100% 0 0 0)"}),w[0]&&gsap.set(w[0],{clipPath:"inset(0% 0 0 0)"}),C(),window.addEventListener("resize",C);const y=document.scrollingElement||document.documentElement,b={index:0,animating:!1,steps:g.length-1};let M,S=!1;x(g[0],0);function E(){const t=document.querySelector(".services__new");if(!t)return!1;const e=t.getBoundingClientRect();return e.top<window.innerHeight&&e.bottom>0}const T=ScrollTrigger.create({trigger:".wrapper",start:"top -5.5%",end:"+="+g.length*d.clientHeight*10,pin:".services__new",scrub:!1,pinType:"fixed",onUpdate:t=>{const e=t.progress;if(h.forEach((t,e)=>{const i=w[e];if(!i)return;const n=t.getBoundingClientRect(),o=d.getBoundingClientRect(),s=o.bottom-n.top,l=o.top-n.bottom;let h=0;if(s>0&&l<0){const t=o.height*r-o.height*a;h=(s-o.height*a)/(t||1),h=Math.min(1,Math.max(0,h))}i.style.clipPath=`inset(${100-100*h}% 0 0 0)`}),!b.animating&&archorTime){const t=Math.min(Math.floor(e*(b.steps+1)),b.steps);t==h.length-1&&(S=!0),t!==b.index&&q(t,{duration:.2})}}});requestAnimationFrame(function t(e){void 0!==lenis&&"function"==typeof lenis.raf&&lenis.raf(e),ScrollTrigger.update(),requestAnimationFrame(t)});let z=0,A=0,L=0;async function q(t,e={}){if(b.animating||M==t)return;const i=Math.max(0,Math.min(t,b.steps));b.index=i,b.animating=!0,L=0;const n=d.clientHeight,o=-i*n;M=t,gsap.to(u,{y:o,duration:e.duration??.8,ease:e.ease??"power2.inOut",onComplete:()=>{b.animating=!1,b.index===b.steps&&gsap.to(u,{y:-b.index*d.clientHeight,duration:.1,ease:"power1.out"})}}),setTimeout(()=>{x(g[i],i)},timeOutShape),c&&c.eq(i).length&&c.eq(i).shuffleLetters({step:5,fps:60,text:c.eq(i).text(),duration:700}),t!==h.length-1||archorTime||(setTimeout(()=>{currentScroll<=T.end&&lenis.scrollTo(T.end,{immediate:!0})},1e3),S=!0,setTimeout(()=>{currentScroll<=T.end&&T.scroll(T.end)},1100)),0===t&&S&&!archorTime&&void 0!==lenis&&(S=!1,setTimeout(()=>{currentScroll>=T.start&&lenis.scrollTo(T.start,{immediate:!0})},1e3),setTimeout(()=>{currentScroll>=T.start&&T.scroll(T.start)},1100))}const R=document.querySelector(".services__new");R.addEventListener("wheel",function(t){if(!E()||b.animating)return;if(!T.isActive)return;const e=0===b.index,i=b.index===b.steps;if(e&&t.deltaY<0||i&&t.deltaY>0)return;t.preventDefault(),t.stopPropagation(),L+=t.deltaY,L>=50?q(b.index+1):L<=-50&&q(b.index-1)},{passive:!1}),R.addEventListener("touchstart",function(t){T.isActive&&(z=t.touches[0].clientY,A=0)},{passive:!1}),R.addEventListener("touchmove",function(t){T.isActive&&(A=t.touches[0].clientY-z,t.preventDefault())},{passive:!1}),R.addEventListener("touchend",function(){if(!E()||b.animating)return;if(!T.isActive)return;q(A<-40?b.index+1:A>40?b.index-1:b.index)},{passive:!1}),R.addEventListener("keydown",function(t){if(!E()||b.animating)return;if(!T.isActive)return;const e=0===b.index,i=b.index===b.steps;if(["ArrowDown","PageDown"," "].includes(t.key))i||q(b.index+1);else{if(!["ArrowUp","PageUp"].includes(t.key))return;e||q(b.index-1)}t.preventDefault()}),window.addEventListener("resize",()=>ScrollTrigger.refresh()),ScrollTrigger.addEventListener("refreshInit",()=>{b.animating&&gsap.killTweensOf(y)}),ScrollTrigger.addEventListener("refresh",function(){E()&&q(b.index,{duration:.001,ease:"none"})}),setTimeout(()=>{if(E()){const t=T.progress,e=Math.round(t*b.steps);b.index=e,q(e,{duration:.001})}},0)}();let resizeTimeout,isVideoLoaded=!1,isPageLoaded=!1;function loadVideoWhenReady(){if(isPageLoaded&&!isVideoLoaded){document.querySelectorAll(".showreel__video").forEach(t=>{const e=[];t.querySelectorAll("source").forEach(t=>{e.push({src:t.src,type:t.type})}),t.innerHTML="",setTimeout(()=>{e.forEach(e=>{const i=document.createElement("source");i.src=e.src,i.type=e.type,t.appendChild(i)}),t.load(),isVideoLoaded=!0},100)})}}function updateMarqueeAnimation(){const t=document.getElementById("marqueeContainer"),e=document.querySelectorAll(".stoke__item");if(!t||0===e.length)return;const i=e[0].scrollWidth,n=t.parentElement.offsetWidth,o=-(i+(parseFloat(getComputedStyle(t).gap)||0))/n*100;let s=document.getElementById("dynamic-marquee");s||(s=document.createElement("style"),s.id="dynamic-marquuee",document.head.appendChild(s)),s.innerHTML=`\n        @keyframes animFooter {\n            0% { \n                transform: translateX(0);\n                opacity: 1;\n            }\n            95% {\n                opacity: 1;\n            }\n            100% { \n                transform: translateX(${o}%);\n                opacity: 1;\n            }\n        }\n        \n        .stroke {\n            animation-fill-mode: both;\n        }\n    `,t.style.animation="none",setTimeout(()=>{t.style.animation=""},10)}function debouncedUpdate(){clearTimeout(resizeTimeout),resizeTimeout=setTimeout(updateMarqueeAnimation,250)}window.addEventListener("load",()=>{isPageLoaded=!0,setTimeout(loadVideoWhenReady,1e3)}),document.addEventListener("DOMContentLoaded",function(){const t=parseFloat(getComputedStyle(document.documentElement).fontSize)||16,e={squareSize:54,gap:0,fillColor:"rgba(244, 244, 244, 0.00)",bgColor:"#000000",fillDuration:.45,delayDuration:.1,clearDuration:.45},i=document.querySelector(".showreel")||document.body,n=document.getElementById("grid-canvas-video");if(!n)return void console.warn("Не найден canvas#grid-canvas-video");const o=n.getContext("2d");function s(e){return e*t}(window.innerWidth||document.documentElement.clientWidth)<=820&&(e.squareSize=20);let a=[],r=[],l=0,h=0;const c=e.fillDuration+e.delayDuration+e.clearDuration;function d(){const t=i.clientWidth,c=i.clientHeight,d=window.devicePixelRatio||1;n.style.width=t+1+"px",n.style.height=c+1+"px",n.width=Math.ceil(t*d),n.height=Math.ceil(c*d),o.setTransform(1,0,0,1,0,0),o.scale(d,d),o.imageSmoothingEnabled=!1;const u=s(e.squareSize),g=s(e.gap);l=Math.ceil(t/(u+g)),h=Math.ceil(c/(u+g)),a=[];for(let t=0;t<h;t++)for(let e=0;e<l;e++)a.push({x:e*(u+g),y:t*(u+g),width:u+1,height:u+1,filled:!1});r=Array.from({length:a.length},(t,e)=>e);for(let t=r.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[r[t],r[e]]=[r[e],r[t]]}m()}function u(t,e,i){return Math.max(e,Math.min(i,t))}function m(){o.clearRect(0,0,n.width,n.height),a.forEach(t=>{o.fillStyle=t.filled?e.fillColor:e.bgColor,o.fillRect(t.x,t.y,t.width,t.height)})}d(),function(){if("undefined"==typeof ScrollMagic)return void console.warn("ScrollMagic не найден — вызов updateAnimation(progress) можно сделать вручную.");const t=new ScrollMagic.Controller,i=Math.max(100,200*c);new ScrollMagic.Scene({triggerElement:".showreel",duration:`${i}%`,triggerHook:1}).on("progress",function(t){!function(t){const i=(t=u(t,0,1))*c,n=e.fillDuration,o=n+e.delayDuration;let s=0;if(i<=n){const t=n>0?i/n:1;s=Math.round(t*a.length)}else if(i<=o)s=a.length;else{const t=1-u(e.clearDuration>0?(i-o)/e.clearDuration:1,0,1);s=Math.round(t*a.length)}s=u(s,0,a.length);for(let t=0;t<a.length;t++){const e=r[t];a[e].filled=t<s}m()}(t.progress)}).addTo(t)}();const g=new ResizeObserver(t=>{for(let e of t)e.target===i&&d()});g.observe(i),window.addEventListener("beforeunload",()=>{g.disconnect()})}),document.getElementById("marqueeContainer")?.addEventListener("animationiteration",function(){this.style.opacity="1"}),document.addEventListener("DOMContentLoaded",function(){setTimeout(updateMarqueeAnimation,100),updateMarqueeAnimation()}),window.addEventListener("resize",debouncedUpdate);