const video=document.querySelector(".priority-video"),videoShowreel=document.querySelector(".showreel__video");function onEntry(t){t.forEach((t=>{t.isIntersecting&&t.target.classList.add("element-show")}))}video.load(),videoShowreel.load(),video.setAttribute("webkit-playsinline",""),video.setAttribute("x-webkit-airplay","allow"),videoShowreel.setAttribute("webkit-playsinline",""),videoShowreel.setAttribute("x-webkit-airplay","allow"),video.addEventListener("loadedmetadata",(function(){video.style.opacity=1})),ScrollTrigger.normalizeScroll(!0),gsap.ticker.lagSmoothing(0),ScrollTrigger.config({limitCallbacks:!0,autoAdjustLag:!0});let lastScrollTop=0;const lenis=new Lenis({lerp:.1,smoothWheel:!0});function raf(t){lenis.raf(t),requestAnimationFrame(raf)}$(window).width()>750&&lenis.on("scroll",(({scroll:t})=>{const e=t,i=document.querySelector(".header");e>lastScrollTop&&e>50?i.classList.add("back"):i.classList.remove("back"),lastScrollTop=e<=0?0:e})),gsap.ticker.add((t=>{lenis.raf(1e3*t)})),gsap.ticker.lagSmoothing(0);let options={threshold:[.5]},observer=new IntersectionObserver(onEntry,options),elements=document.querySelectorAll(".element-animation");for(let t of elements)observer.observe(t);$(".burger").on("click",(function(t){$(".header__mobile").toggleClass("show"),$(this).find(".current").toggleClass("show")})),$(".header__mobile-menu ul li").on("click",(function(t){$(".header__mobile").removeClass("show"),$(this).find(".current").removeClass("show")}));let width=$(window).width();width<=750?($(".header__body-menu").remove(),$(".about-p1").remove(),$(".difference").text("уровня сетевых"),$(".difference2").text("рекламных"),$(".brand").attr("placeholder","Имя бренда")):($(".burger").remove(),$(".about-p2").remove(),$(".difference").text("уровня"),$(".difference2").text("сетевых рекламных"),$(".header__mobile").remove(),$(".muteor").remove());const canvas=document.getElementById("pixelCanvas"),ctx=canvas.getContext("2d"),img=new Image;img.src="../images/dist/about.webp";const ABOUTCONFIG={animCanvas:-250,StartAnim:"top top",StartAnimPixel:"top top",endAnim:"+=30%"};function initCanvas(){canvas.width=img.width,canvas.height=img.height,renderPixelated(20)}function renderPixelated(t){ctx.imageSmoothingEnabled=!1,ctx.clearRect(0,0,canvas.width,canvas.height);const e=Math.floor(canvas.width/t),i=Math.floor(canvas.height/t);ctx.drawImage(img,0,0,e,i),ctx.drawImage(canvas,0,0,e,i,0,0,canvas.width,canvas.height)}if(width<=750&&(ABOUTCONFIG.animCanvas=-50,ABOUTCONFIG.StartAnim="top center",ABOUTCONFIG.StartAnimPixel="+=10%",ABOUTCONFIG.endAnim="+=30%"),img.onload=function(){initCanvas(),window.addEventListener("resize",initCanvas),gsap.to(canvas,{y:ABOUTCONFIG.animCanvas,scrollTrigger:{trigger:".about",start:ABOUTCONFIG.StartAnim,end:"bottom center",scrub:2,ease:"sine.inOut"}}),gsap.to(".ab_dec1",{y:"0%",opacity:1,scrollTrigger:{trigger:".about",start:"-=60%",end:"-=20%",scrub:2,ease:"sine.inOut"}}),gsap.to(".ab_dec2",{y:"0%",opacity:1,scrollTrigger:{trigger:".about",start:"-=20%",end:"+=40%",scrub:2,ease:"sine.inOut"}}),gsap.to(".ab_dec3",{y:"0%",opacity:1,scrollTrigger:{trigger:".about",start:"+=10%",end:"+=30%",scrub:2,ease:"sine.inOut"}}),gsap.to(".benefits__decor--1",{y:"0%",opacity:1,scrollTrigger:{trigger:".benefits",start:"-=30%",end:"+=30%",scrub:2,ease:"sine.inOut"}});const t={pixelSize:20};gsap.to(t,{scrollTrigger:{trigger:".about",start:ABOUTCONFIG.StartAnimPixel,end:ABOUTCONFIG.endAnim,scrub:1,ease:"sine.inOut"},pixelSize:1,onUpdate:function(){renderPixelated(t.pixelSize)}})},document.addEventListener("DOMContentLoaded",(()=>{const t={squareSize:40,fillColor:"#000000",initialFillRatio:.3,animationDuration:50,staggerDelay:2};width<=750&&(t.squareSize=20);const e=document.querySelector(".feedback_btn"),i=e.querySelector(".btn_canvas"),o=i.getContext("2d");let s=[],n=!1;function a(){const o=e.offsetWidth,n=e.offsetHeight;i.width=o,i.height=n;const a=t.squareSize*parseFloat(getComputedStyle(document.documentElement).fontSize);const l=Math.ceil(o/a),h=Math.ceil(n/a);s=[];for(let e=0;e<h;e++)for(let i=0;i<l;i++)s.push({x:i*a,y:e*a,width:a,height:a,filled:Math.random()<t.initialFillRatio,initialFilled:!1,progress:0});s.forEach((t=>{t.initialFilled=t.filled})),r()}function r(){o.clearRect(0,0,i.width,i.height),s.forEach((e=>{(e.filled||e.progress>0)&&(o.fillStyle=t.fillColor,o.globalAlpha=e.filled?1:e.progress,o.fillRect(e.x,e.y,e.width,e.height),o.globalAlpha=1)}))}async function l(e,i,o){return new Promise((s=>{setTimeout((()=>{const o=performance.now();requestAnimationFrame((function n(a){const l=a-o,h=Math.min(l/t.animationDuration,1);e.progress=i?h:1-h,r(),h<1?requestAnimationFrame(n):(e.filled=i,e.progress=0,s())}))}),o)}))}a(),e.addEventListener("mouseenter",(async function(){n=!0;const e=[...s].sort((()=>Math.random()-.5));for(let i=0;i<e.length&&n;i++){const o=e[i];o.filled||await l(o,!0,i*t.staggerDelay)}})),e.addEventListener("mouseleave",(async function(){n=!1;const e=[...s].sort((()=>Math.random()-.5));for(let i=0;i<e.length&&!n;i++){const o=e[i];o.filled&&!o.initialFilled&&await l(o,!1,i*t.staggerDelay)}})),window.addEventListener("resize",a)})),document.addEventListener("DOMContentLoaded",(()=>{const t=window.innerWidth,e=new ScrollMagic.Controller,i=t>750;class o{constructor(t){this.media=t,this.img=t.querySelector("img"),this.canvas=t.querySelector(".grid-canvas-case"),this.ctx=this.canvas.getContext("2d"),this.pixelSize=20,this.isGridActive=!1,this.mouse={x:-1e3,y:-1e3},i&&(this.blurCanvas=document.createElement("canvas"),this.blurCtx=this.blurCanvas.getContext("2d")),this.settings={cellSize:54,effectRadius:120,blurRadius:10,fillColor:"rgba(244,244,244,0.9)"},this.img.onload=()=>this.init(),this.img.complete&&this.init(),this.setupEvents()}init(){this.resizeCanvas(),this.originalCanvas=document.createElement("canvas"),this.originalCanvas.width=this.canvas.width,this.originalCanvas.height=this.canvas.height,this.originalCtx=this.originalCanvas.getContext("2d"),this.originalCtx.drawImage(this.img,0,0,this.canvas.width,this.canvas.height),i&&(this.blurCanvas.width=this.canvas.width,this.blurCanvas.height=this.canvas.height,this.blurCtx.drawImage(this.originalCanvas,0,0),this.applyBlur()),this.startAnimation()}resizeCanvas(){this.canvas.width=this.media.offsetWidth,this.canvas.height=this.media.offsetHeight}setupEvents(){i&&(this.media.addEventListener("mousemove",(t=>{const e=this.canvas.getBoundingClientRect();this.mouse.x=t.clientX-e.left,this.mouse.y=t.clientY-e.top,this.isGridActive=!0})),this.media.addEventListener("mouseleave",(()=>{this.isGridActive=!1})))}applyBlur(){const{width:t,height:e}=this.blurCanvas,i=this.settings.blurRadius,o=this.blurCtx,s=o.getImageData(0,0,t,e),n=s.data,a=new Uint8ClampedArray(n);for(let o=0;o<e;o++)for(let s=0;s<t;s++){let r=0,l=0,h=0,c=0;for(let n=-i;n<=i;n++)for(let d=-i;d<=i;d++){const i=s+d,g=o+n;if(i>=0&&i<t&&g>=0&&g<e){const e=4*(g*t+i);r+=a[e],l+=a[e+1],h+=a[e+2],c++}}const d=4*(o*t+s);n[d]=r/c,n[d+1]=l/c,n[d+2]=h/c}o.putImageData(s,0,0)}renderPixelated(t){const e=this.ctx,i=this.canvas,o=this.originalCanvas;if(e.imageSmoothingEnabled=!1,e.clearRect(0,0,i.width,i.height),t<=1)return void e.drawImage(o,0,0,i.width,i.height);const s=Math.floor(i.width/t),n=Math.floor(i.height/t);e.drawImage(o,0,0,s,n),e.drawImage(i,0,0,s,n,0,0,i.width,i.height)}drawGrid(){if(!i||!this.isGridActive)return;const{cellSize:t,effectRadius:e}=this.settings,o=this.mouse.x,s=this.mouse.y,n=Math.max(0,Math.floor((o-e)/t)),a=Math.min(Math.ceil(this.canvas.width/t),Math.ceil((o+e)/t)),r=Math.max(0,Math.floor((s-e)/t)),l=Math.min(Math.ceil(this.canvas.height/t),Math.ceil((s+e)/t)),h=e*e;for(let i=r;i<l;i++)for(let r=n;r<a;r++){const n=r*t,a=i*t,l=(n+t/2-o)**2+(a+t/2-s)**2;if(l<h){this.ctx.drawImage(this.blurCanvas,n,a,t,t,n,a,t,t);const i=.4*(1-Math.sqrt(l)/e);this.ctx.fillStyle=`rgba(244,244,244,${i.toFixed(3)})`,this.ctx.fillRect(n,a,t,t)}}}startAnimation(){this.rafId||(this.rafId=requestAnimationFrame((()=>this.animate())))}animate(){this.renderPixelated(this.pixelSize),i&&this.drawGrid(),this.rafId=requestAnimationFrame((()=>this.animate()))}stopAnimation(){this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null)}setPixelSize(t){this.pixelSize=t}}const s=document.querySelectorAll(".case__soft .item"),n=[];let a=0;function r(){const t=150*s.length+"%",o=gsap.timeline();n.forEach(((t,e)=>{const n=s[e],a=i?1:1.5,r=i?.6:.8,l=i?.2:.5,h=gsap.timeline().fromTo(n,{y:0,opacity:1},{top:"-95%",opacity:1,duration:a}).to({size:20},{size:1,duration:r,ease:"power2.out",onUpdate(){t.setPixelSize(this.targets()[0].size)}},0);o.add(h,e*l)})),new ScrollMagic.Scene({triggerElement:".case",triggerHook:"onLeave",duration:t,offset:0}).setPin(".case").setTween(o).addTo(e)}s.forEach(((t,e)=>{const i=t.querySelector(".media"),l=new o(i);n.push(l),l.img.onload=()=>{a++,a===s.length&&r()},l.img.complete&&(a++,a===s.length&&r())}))})),width>750){gsap.set(".cursor",{xPercent:-50,yPercent:-50}),$(document).mousemove((function(t){gsap.to(".cursor",{x:t.clientX,y:t.clientY,duration:.1,ease:"power1.out"})})),$(document).on("mouseenter","a",(function(){console.log($(this).attr("href"));let t=$(this).attr("href");$(".default_text").fadeIn(200),t.includes("tel")?($(".default_text").text("Позвонить"),$(".cursor .phone").css({scale:"1"}),$(".cursor svg").not(".cursor .arrow").css({scale:0})):t.includes("mail")?($(".cursor .mail").css({scale:"1"}),$(".cursor svg").not(".cursor .arrow").css({scale:0}),$(".default_text").text("Написать")):($(".default_text").text("Клик"),$(".cursor .arrow").css({scale:"1"}),$(".cursor svg").not(".cursor .arrow").css({scale:0}))})).on("mouseleave","a",(function(){$(".cursor svg").css({scale:"0"}),$(".default_text").fadeOut(200)})),$(document).on({mouseleave:function(){$(".cursor svg").css("scale","0"),$(".default_text").fadeOut(200)},mousemove:function(){updateVideoCursor()},click:function(t){t.preventDefault(),toggleVideoPlayback()}},".showreel");const e=document.querySelector(".showreel__video");function toggleVideoPlayback(){e&&(e.paused||e.ended?e.play().catch((t=>console.error("Video play error:",t))):e.pause(),updateVideoCursor())}function updateVideoCursor(){if(!e)return;const t=!e.paused&&!e.ended,i=$(".cursor");i.find(".pause").css("scale",t?"1":"0"),i.find(".play").css("scale",t?"0":"1"),$(".default_text").fadeIn(200),$(".default_text").text(t?"Пауза":"воспроизвести")}}$(".muteor").on("click",(function(t){const e=document.querySelector(".showreel__video");e.muted?(e.muted=!1,$(".mute").fadeIn(300),$(".sound").fadeOut(300)):(e.muted=!0,$(".mute").fadeOut(300),$(".sound").fadeIn(300))}));class SectionGrid{constructor(t){this.section=t,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.cellPool=[],this.mouse={x:-1e3,y:-1e3},this.rafId=null,this.isActive=!0,this.sectionTop=0,this.settings={baseSize:54,sizeVariation:0,spacing:0,activationRadius:120,fadeSpeed:.01,maxRotation:0,rotationSpeed:0,borderColor:{r:244,g:244,b:244,a:.24},fillColor:{r:0,g:0,b:0,a:0},borderWidth:1,offsetX:0,offsetY:0},t.classList.contains("services__new")&&(this.settings.offsetX=1,this.settings.offsetY=-25),t.classList.contains("client")&&(this.settings.offsetX=0,this.settings.offsetY=11),t.classList.contains("main")&&(this.settings.offsetX=27,this.settings.offsetY=-27),t.classList.contains("feedback")&&(this.settings.offsetX=27,this.settings.offsetY=-24),this.init()}remToPx(t){return t*(window.innerWidth/1920)}init(){this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="1",this.canvas.style.imageRendering="pixelated",this.section.style.position="relative",this.section.appendChild(this.canvas),this.updateSectionPosition(),this.resize(),this.initPool(),this.startAnimation()}updateSectionPosition(){this.rect=this.section.getBoundingClientRect(),this.sectionTop=this.rect.top+window.scrollY}resize(){this.rect=this.section.getBoundingClientRect();const t=window.devicePixelRatio||1;this.canvas.style.width=this.rect.width+"px",this.canvas.style.height=this.rect.height+"px",this.canvas.width=this.rect.width*t,this.canvas.height=this.rect.height*t,this.ctx.scale(t,t);const e=this.remToPx(this.settings.baseSize);this.remToPx(this.settings.spacing);this.gridCols=Math.ceil(this.rect.width/e),this.gridRows=Math.ceil(this.rect.height/e)}initPool(){this.cellPool=[];const t=this.remToPx(this.settings.baseSize),e=this.remToPx(this.settings.offsetX),i=this.remToPx(this.settings.offsetY),o=(this.rect.width-this.gridCols*t)/2+e,s=(this.rect.height-this.gridRows*t)/2+i;for(let e=0;e<this.gridRows;e++)for(let i=0;i<this.gridCols;i++)this.cellPool.push({x:o+i*t,y:s+e*t,width:t,height:t,rotation:0,targetRotation:0,alpha:0,active:!1,lastActiveTime:0,borderWidth:Math.floor(this.remToPx(this.settings.borderWidth))})}updateMousePosition(t,e){const i=this.section.getBoundingClientRect();this.mouse.x=t-i.left,this.mouse.y=e-i.top}updateCells(){const t=this.remToPx(this.settings.activationRadius),e=t*t,i=performance.now();for(let t of this.cellPool){const o=this.mouse.x-(t.x+t.width/2),s=this.mouse.y-(t.y+t.height/2),n=o*o+s*s;n<e?(t.active=!0,t.lastActiveTime=i,t.targetRotation=Math.atan2(s,o)+Math.PI/2,t.alpha=Math.min(1,1-n/e)):(t.active&&i-t.lastActiveTime>300&&(t.active=!1),t.alpha=Math.max(0,t.alpha-this.settings.fadeSpeed),t.targetRotation=0),t.rotation+=(t.targetRotation-t.rotation)*this.settings.rotationSpeed}}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.imageSmoothingEnabled=!1,this.ctx.fillStyle=`rgba(${this.settings.fillColor.r}, ${this.settings.fillColor.g}, ${this.settings.fillColor.b}, ${this.settings.fillColor.a})`,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);for(let t of this.cellPool){if(t.alpha<=0)continue;const e=Math.floor(t.x),i=Math.floor(t.y),o=t.width;this.ctx.save(),this.ctx.translate(e+o/2,i+o/2),this.ctx.rotate(t.rotation),this.ctx.fillStyle=`rgba(\n        ${this.settings.fillColor.r}, \n        ${this.settings.fillColor.g}, \n        ${this.settings.fillColor.b}, \n        ${this.settings.fillColor.a*t.alpha}\n      )`,this.ctx.fillRect(-o/2,-o/2,o,o),this.ctx.strokeStyle=`rgba(\n        ${this.settings.borderColor.r}, \n        ${this.settings.borderColor.g}, \n        ${this.settings.borderColor.b}, \n        ${this.settings.borderColor.a*t.alpha}\n      )`,this.ctx.lineWidth=t.borderWidth,this.ctx.strokeRect(-o/2,-o/2,o,o),this.ctx.restore()}}startAnimation(){this.rafId||this.animate()}animate(){this.updateCells(),this.draw(),this.rafId=requestAnimationFrame((()=>this.animate()))}}class GridSystem{constructor(){this.sectionGrids=[],this.mouse={x:-1e3,y:-1e3},this.scrollY=window.scrollY,this.lastScrollY=window.scrollY,this.init()}init(){document.querySelectorAll('[data-grid="true"]').forEach((t=>{this.sectionGrids.push(new SectionGrid(t))})),document.addEventListener("mousemove",(t=>{this.mouse.x=t.clientX,this.mouse.y=t.clientY,this.sectionGrids.forEach((e=>{const i=e.section.getBoundingClientRect();i.top<window.innerHeight&&i.bottom>0&&e.updateMousePosition(t.clientX,t.clientY)}))})),document.addEventListener("mouseout",(()=>{this.mouse.x=-1e3,this.mouse.y=-1e3})),window.addEventListener("scroll",(()=>{this.lastScrollY=this.scrollY,this.scrollY=window.scrollY,this.sectionGrids.forEach((t=>{t.updateSectionPosition()}))}),{passive:!0}),window.addEventListener("resize",(()=>{this.sectionGrids.forEach((t=>{t.resize(),t.updateSectionPosition()}))}))}}width>750&&document.addEventListener("DOMContentLoaded",(()=>{new GridSystem})),document.addEventListener("DOMContentLoaded",(()=>{const t={squareSize:54,gap:0,fillColor:"#442CBF",bgColor:"#000000",animationDuration:1e3,widthView:1920};function e(e){return e*(window.innerWidth/t.widthView)}width<=750&&(t.widthView=375,t.squareSize=20);const i=document.getElementById("feedback-grid-canvas"),o=i.getContext("2d");let s=[],n=[],a=0;function r(){const r=document.querySelector(".feedback__top"),h=r.clientWidth,c=r.clientHeight,d=window.devicePixelRatio||1;i.style.width=h+"px",i.style.height=c+"px",i.width=Math.floor(h*d),i.height=Math.floor(c*d),o.scale(d,d);const g=Math.floor(e(t.squareSize)),u=Math.floor(e(t.gap)),f=Math.ceil(h/(g+u))+1,m=Math.ceil(c/(g+u))+1,p=f*(g+u),w=m*(g+u),v=Math.floor((h-p)/2),y=Math.floor((c-w)/2);s=[];for(let t=-1;t<m;t++)for(let e=-1;e<f;e++)s.push({x:e*(g+u)+v,y:t*(g+u)+y,width:g,height:g,filled:!1});n=[...Array(s.length).keys()],function(t){for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}}(n),a=0,l()}function l(){o.clearRect(0,0,i.width,i.height),o.imageSmoothingEnabled=!1,o.fillStyle=t.bgColor,o.fillRect(0,0,i.width,i.height),s.forEach((e=>{const i=Math.floor(e.x),s=Math.floor(e.y),n=Math.floor(e.width);o.fillStyle=e.filled?t.fillColor:t.bgColor,o.fillRect(i,s,n,n)}))}const h=new ScrollMagic.Controller;let c;new ScrollMagic.Scene({triggerElement:".feedback",duration:t.animationDuration,triggerHook:1}).on("progress",(e=>{!function(t){if(t<a)for(let e=a-1;e>=t;e--)e>=0&&e<n.length&&(s[n[e]].filled=!1);else for(let e=a;e<t;e++)e>=0&&e<n.length&&(s[n[e]].filled=!0);a=t,l()}(Math.floor(e.progress*s.length)),e.progress>=.99?i.style.background=t.fillColor:i.style.background="transparent"})).addTo(h),r(),window.addEventListener("resize",(()=>{clearTimeout(c),c=setTimeout((()=>{r(),h.update()}),100)}))})),$(".feedback_btn").on("click",(function(t){let e=0;$(".inputs input").each((function(t){""==$(this).val()?$(this).addClass("error"):($(this).removeClass("error"),e++)})),5==e&&($(".feedback__bot-form").fadeOut(300),$(".feedback__bot-thank").fadeIn(300),$(".title__feed").text("Спасибо!"))})),document.addEventListener("DOMContentLoaded",(()=>{const t={squareSize:54,gap:0,fillColor:"#000000",bgColor:"#F4F4F403",animationDuration:500,widthView:1920};function e(e){return e*(window.innerWidth/t.widthView)}width<=750&&(t.widthView=375,t.squareSize=20);const i=document.getElementById("grid-canvas-begin"),o=i.getContext("2d");let s=[],n=[],a=0;function r(){const r=document.querySelector(".main"),h=r.clientWidth,c=r.clientHeight,d=window.devicePixelRatio||1;i.style.width=h+"px",i.style.height=c+"px",i.width=Math.floor(h*d),i.height=Math.floor(c*d),o.scale(d,d);const g=Math.floor(e(t.squareSize)),u=Math.floor(e(t.gap)),f=Math.ceil(h/(g+u))+1,m=Math.ceil(c/(g+u))+1,p=f*(g+u),w=m*(g+u),v=Math.floor((h-p)/2),y=Math.floor((c-w)/2);s=[];for(let t=-1;t<m;t++)for(let e=-1;e<f;e++)s.push({x:e*(g+u)+v,y:t*(g+u)+y,width:g,height:g,filled:!1});n=[...Array(s.length).keys()],function(t){for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}}(n),a=0,l()}function l(){o.clearRect(0,0,i.width,i.height),o.imageSmoothingEnabled=!1,o.fillStyle=t.bgColor,o.fillRect(0,0,i.width,i.height),s.forEach((e=>{const i=Math.floor(e.x),s=Math.floor(e.y),n=Math.floor(e.width);o.fillStyle=e.filled?t.fillColor:t.bgColor,o.fillRect(i,s,n,n)}))}const h=new ScrollMagic.Controller;let c;new ScrollMagic.Scene({triggerElement:".main",duration:t.animationDuration,triggerHook:0}).on("progress",(t=>{!function(t){if(t<a)for(let e=a-1;e>=t;e--)e>=0&&e<n.length&&(s[n[e]].filled=!1);else for(let e=a;e<t;e++)e>=0&&e<n.length&&(s[n[e]].filled=!0);a=t,l()}(Math.floor(t.progress*s.length)),t.progress>=.99?i.style.background="#000":i.style.background="transparent"})).addTo(h),r(),window.addEventListener("resize",(()=>{clearTimeout(c),c=setTimeout((()=>{r(),h.update()}),100)}))})),document.addEventListener("DOMContentLoaded",(()=>{const t={squareSize:54,fillColor:"#442CBF",bgColor:"#000000",animationDelay:500,fillDuration:1500,fadeDuration:2500,logoMoveDuration:1e3,targetLogoPosition:{x:40,y:53},sizeLogo:{width:200,height:50}};width<=750&&(t.squareSize=20,t.targetLogoPosition.x=20,t.targetLogoPosition.y=20,t.sizeLogo.width=120,t.sizeLogo.height=30);const e=document.querySelector(".preload-container"),i=document.querySelector(".preload-canvas"),o=i.getContext("2d"),s=e.querySelector("img"),n=document.querySelector("#js-cursor-progress span"),a=(document.body,document.querySelector(".header__body-logo"));let r,l,h=[],c={x:0,y:0};function d(){i.width=window.innerWidth,i.height=window.innerHeight;const e=Math.ceil(i.width/t.squareSize)+1,o=Math.ceil(i.height/t.squareSize)+1;h=[];for(let i=-1;i<o;i++)for(let o=-1;o<e;o++)h.push({x:o*t.squareSize,y:i*t.squareSize,width:t.squareSize,height:t.squareSize,state:"black",alpha:1});u(),g()}function g(){for(let t=h.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[h[t],h[e]]=[h[e],h[t]]}}function u(){o.clearRect(0,0,i.width,i.height),h.forEach((e=>{"black"===e.state?(o.fillStyle=t.bgColor,o.globalAlpha=e.alpha,o.fillRect(e.x,e.y,e.width,e.height)):"color"===e.state&&(o.fillStyle=t.fillColor,o.globalAlpha=e.alpha,o.fillRect(e.x,e.y,e.width,e.height))})),o.globalAlpha=1}function f(e){l||(l=e);const i=e-l,o=Math.min(i/t.fillDuration,1),s=Math.floor(o*h.length);for(let t=0;t<s;t++)t<h.length&&(h[t].state="color");const a=Math.floor(99*o);n.textContent=`${a.toString().padStart(2,"0")}%`,u(),o<1?r=requestAnimationFrame(f):(l=null,g(),r=requestAnimationFrame(m))}function m(o){l||(l=o),i.style.background="transparent";const d=o-l,g=Math.min(d/t.fadeDuration,1),f=Math.min(d/t.logoMoveDuration,1),p=(w=f,1-Math.pow(1-w,3));var w;const v=c.x+(t.targetLogoPosition.x-c.x)*p,y=c.y+(t.targetLogoPosition.y-c.y)*p;s.style.left=`${v}rem`,s.style.top=`${y}rem`,s.style.width=`${t.sizeLogo.width}rem`,s.style.height=`${t.sizeLogo.height}rem`,setTimeout((()=>{a.style.opacity="1"}),2e3),setTimeout((()=>{$(".main__body .stroke div").addClass("anim_stroke")}),2e3);const x=Math.floor(g*h.length);for(let t=0;t<x;t++)t<h.length&&(h[t].state="transparent",h[t].alpha=1-g);n.parentElement&&(n.parentElement.style.opacity=1-g),u(),g<1?r=requestAnimationFrame(m):(s.style.left=`${t.targetLogoPosition.x}rem`,s.style.top=`${t.targetLogoPosition.y}rem`,e.style.transition="opacity 0.5s ease",e.style.opacity="0",setTimeout((()=>{e.remove()}),500))}d(),function(){const e=(window.innerWidth-s.offsetWidth)/2,i=(window.innerHeight-s.offsetHeight)/2;c={x:e/parseFloat(getComputedStyle(document.documentElement).fontSize),y:i/parseFloat(getComputedStyle(document.documentElement).fontSize)},setTimeout((()=>{l=null,r=requestAnimationFrame(f)}),t.animationDelay)}(),window.addEventListener("resize",(()=>{cancelAnimationFrame(r),d(),u()}))}));const wrapper=document.querySelector(".wrapper"),wrapperImages=document.querySelectorAll(".wrapper img"),itemsLine=document.querySelector(".items__line"),items=document.querySelectorAll(".items__line .item"),ANIMATION_SETTINGS={startOffset:.16,endOffset:.84};gsap.set(wrapperImages,{clipPath:"inset(100% 0 0 0)"}),gsap.set(wrapperImages[0],{clipPath:"inset(0% 0 0 0)"}),ScrollTrigger.create({trigger:".services__new",start:"top -=5.5%",end:`+=${100*(items.length-1)}%`,pin:!0,scrub:1,onUpdate:t=>{t.progress;gsap.to(itemsLine,{top:`-${100*t.progress*(items.length-1)}%`,ease:"none"}),items.forEach(((t,e)=>{if(0===e)return;const i=wrapperImages[e],o=t.getBoundingClientRect(),s=wrapper.getBoundingClientRect(),n=s.bottom-o.top,a=s.top-o.bottom;let r=0;if(n>0&&a<0){const t=s.height*ANIMATION_SETTINGS.endOffset-s.height*ANIMATION_SETTINGS.startOffset;r=(n-s.height*ANIMATION_SETTINGS.startOffset)/t,r=Math.min(1,Math.max(0,r))}gsap.to(i,{clipPath:`inset(${100-100*r}% 0 0 0)`,duration:.1,overwrite:!0})}))}}),document.addEventListener("DOMContentLoaded",(function(){const t=parseFloat(getComputedStyle(document.documentElement).fontSize),e={squareSize:54,gap:0,fillColor:"rgba(244, 244, 244, 0.03)",bgColor:"#000000",fillDuration:.45,delayDuration:.1,clearDuration:.45};function i(e){return e*t}width<=750&&(e.squareSize=20);const o=document.getElementById("grid-canvas-video"),s=o.getContext("2d"),n=document.querySelector(".showreel");let a=[],r=[],l=0;function h(){const t=Math.floor(n.clientWidth),l=Math.floor(n.clientHeight),h=window.devicePixelRatio||1;o.style.width=t+"px",o.style.height=l+"px",o.width=Math.floor(t*h),o.height=Math.floor(l*h),s.scale(h,h);const d=Math.floor(i(e.squareSize)),g=Math.floor(i(e.gap)),u=Math.ceil(t/(d+g)),f=Math.ceil(l/(d+g)),m=u*(d+g),p=f*(d+g),w=Math.max(0,(t-m)/2),v=Math.max(0,(l-p)/2);a=[];for(let t=0;t<f;t++)for(let e=0;e<u;e++){const i=Math.floor(e*(d+g)+w),o=Math.floor(t*(d+g)+v);a.push({x:i,y:o,width:d,height:d,filled:!1})}r=Array.from({length:a.length},((t,e)=>e));for(let t=r.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[r[t],r[e]]=[r[e],r[t]]}c()}function c(){s.clearRect(0,0,o.width,o.height),s.imageSmoothingEnabled=!1,a.forEach((t=>{const i=Math.floor(t.x),o=Math.floor(t.y),n=Math.floor(t.width),a=Math.floor(t.height);s.fillStyle=t.filled?e.fillColor:e.bgColor,s.fillRect(i,o,n,a)}))}h(),function(){const t=new ScrollMagic.Controller,i=e.fillDuration+e.delayDuration+e.clearDuration;new ScrollMagic.Scene({triggerElement:".showreel",duration:200*i+"%",triggerHook:1}).on("progress",(function(t){!function(t){const i=t>l;l=t;const o=e.fillDuration,s=o+e.delayDuration,n=o+e.delayDuration+e.clearDuration;if(i)if(t<=o){const e=t/o,i=Math.floor(e*a.length);for(let t=0;t<i;t++)a[r[t]].filled=!0}else if(t<=s)a.forEach((t=>t.filled=!0));else{const i=(t-s)/e.clearDuration,o=Math.floor(i*a.length);if(t>=.99*n)a.forEach((t=>t.filled=!1));else for(let t=0;t<o;t++)a[r[a.length-1-t]].filled=!1}else if(t>=s){const i=(t-s)/e.clearDuration,o=a.length-Math.floor(i*a.length);for(let t=0;t<o;t++)a[r[t]].filled=!0}else if(t>=o)a.forEach((t=>t.filled=!0));else{const e=t/o,i=a.length-Math.floor(e*a.length);for(let t=0;t<i;t++)a[r[t]].filled=!1}c()}(t.progress)})).addTo(t)}();const d=new ResizeObserver((t=>{for(let e of t)e.target===n&&h()}));d.observe(n),window.addEventListener("beforeunload",(()=>{d.disconnect()}))}));